Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex.
[02;37m[2020-08-20 21:12:42,496][onir.config][WARNING] [0m[33mArgument vocab.source=glove set but no matching setting in <class 'onir.vocab.bert_vocab.BertVocab'>[0m
[02;37m[2020-08-20 21:12:42,497][onir.config][WARNING] [0m[33mArgument vocab.variant=cc-42b-300d set but no matching setting in <class 'onir.vocab.bert_vocab.BertVocab'>[0m
[02;37m[2020-08-20 21:12:48,938][vocab:bert][DEBUG] [0m[37m[starting] loading BERT weights from ../data/vocab/bert/config1[0m
[02;37m[2020-08-20 21:12:49,354][vocab:bert][DEBUG] [0m[37m[finished] loading BERT weights from ../data/vocab/bert/config1 [417ms][0m
[02;37m[2020-08-20 21:12:49,384][trainer:pairwise][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-20 21:12:49,390][onir.injector][DEBUG] [0m[37mConfiguration:[0m
 vocab       bert                                                            
-----------------------------------------------------------------------------
 bert_base   bert-base-uncased  |  bert_weights  [33mconfig1[0m  |  layer     -1    
 last_layer  False              |  train         [33mTrue[0m     |  encoding  joint 

 train_ds  covid                                                                  
----------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mtrf2-rnd5-quest[0m  |  ranktopk  1000 
 date      2020-07-16          |  2020_filter  [33mTrue[0m             |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m       |  fold      all  

 ranker  cedr_knrm                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------
 qlen    [33m40[0m                                                |  dlen    2000                                           |  add_runscore  [33mTrue[0m 
 mus     -0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.0  |  sigmas  0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.001  |  grad_kernels  True 

 trainer     pairwise                                                                                                    
-------------------------------------------------------------------------------------------------------------------------
 batch_size  16        |  batches_per_epoch  32         |  grad_acc_batch  [33m1[0m                                             
 optimizer   adam      |  lr                 0.001      |  gpu             True                                          
 gpu_determ  True      |  encoder_lr         [33m2e-05[0m      |  pipeline        [33mmsmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m 
 lossfn      softmax   |  pos_source         intersect  |  neg_source      run                                           
 sampling    query     |  pos_minrel         1          |  unjudged_rel    0                                             
 num_neg     1         |  margin             0.0                                                                         

 valid_ds  covid                                                                  
----------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mvaf2-rnd5-quest[0m  |  ranktopk  [33m20[0m   
 date      2020-07-16          |  2020_filter  [33mTrue[0m             |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m       |  fold      all  

 valid_pred  reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  [33m4[0m         |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 test_ds   covid                                                                
--------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mf2-rnd5-quest[0m  |  ranktopk  [33m500[0m  
 date      2020-07-16          |  2020_filter  [33mTrue[0m           |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m     |  fold      all  

 test_pred   reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  [33m4[0m         |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 pipeline      jesus                                                  
----------------------------------------------------------------------
 max_epoch     1000    |  early_stop     20     |  warmup       -1    
 val_metric    [33mmrr@10[0m  |  purge_weights  True   |  test         False 
 initial_eval  False   |  skip_ds_init   False  |  only_cached  False 
 onlytest      False   |  finetune       [33mTrue[0m   |  savefile     _     
[0m
[02;37m[2020-08-20 21:12:49,390][valid_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-20 21:12:49,393][trainer:pairwise][INFO] [0m[32mtrain path: ../data/models/config1/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config1_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m
[02;37m[2020-08-20 21:12:52,705][trainer:pairwise][INFO] [0m[32mloading prev model : ../data/models/config1/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config1_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m
[02;37m[2020-08-20 21:12:57,080][train_ds:covid][DEBUG] [0m[37m[starting] reading bm25_k1-3.9_b-0.55:1000[0m
[02;37m[2020-08-20 21:12:57,118][train_ds:covid][DEBUG] [0m[37m[finished] reading bm25_k1-3.9_b-0.55:1000 [38ms][0m
[02;37m[2020-08-20 21:12:57,175][onir.interfaces.java][DEBUG] [0m[37m[starting] initializing jnius[0m
[02;37m[2020-08-20 21:12:57,938][onir.interfaces.java][DEBUG] [0m[37m[finished] initializing jnius [763ms][0m
[02;37m[2020-08-20 21:14:05,221][pipeline:jesus][DEBUG] [0m[37m[train] epoch=0 loss=0.3239 acc=0.6836 unsup_acc=0.5371 delta_acc=0.1465[0m
[02;37m[2020-08-20 21:14:05,226][valid_ds:covid][DEBUG] [0m[37m[starting] reading bm25_k1-3.9_b-0.55:20[0m
[02;37m[2020-08-20 21:14:05,226][valid_ds:covid][DEBUG] [0m[37m[finished] reading bm25_k1-3.9_b-0.55:20 [1ms][0m
[02;37m[2020-08-20 21:14:05,227][valid_ds:covid][DEBUG] [0m[37m[starting] reading bm25_k1-3.9_b-0.55:20[0m
[02;37m[2020-08-20 21:14:05,234][valid_ds:covid][DEBUG] [0m[37m[finished] reading bm25_k1-3.9_b-0.55:20 [7ms][0m
[02;37m[2020-08-20 21:14:08,706][pipeline:jesus][INFO] [0m[32m[valid] epoch=0 map=0.0318 [mrr@10=0.8889] ndcg@10=0.5273 ndcg@20=0.4854 p@20=0.4944 runscore_alpha=0.2844 <---[0m
[02;37m[2020-08-20 21:15:13,774][pipeline:jesus][DEBUG] [0m[37m[train] epoch=1 loss=0.2347 acc=0.7676 unsup_acc=0.5410 delta_acc=0.2266[0m
[02;37m[2020-08-20 21:15:17,597][pipeline:jesus][INFO] [0m[32m[valid] epoch=1 map=0.0325 [mrr@10=1.0000] ndcg@10=0.5726 ndcg@20=0.5027 p@20=0.4944 runscore_alpha=0.2858 <---[0m
[02;37m[2020-08-20 21:16:24,818][pipeline:jesus][DEBUG] [0m[37m[train] epoch=2 loss=0.2187 acc=0.7754 unsup_acc=0.5645 delta_acc=0.2109[0m
[02;37m[2020-08-20 21:16:28,471][pipeline:jesus][INFO] [0m[32m[valid] epoch=2 map=0.0310 [mrr@10=0.8704] ndcg@10=0.5427 ndcg@20=0.4844 p@20=0.4944 runscore_alpha=0.2869[0m
[02;37m[2020-08-20 21:17:35,977][pipeline:jesus][DEBUG] [0m[37m[train] epoch=3 loss=0.1825 acc=0.8184 unsup_acc=0.5273 delta_acc=0.2910[0m
[02;37m[2020-08-20 21:17:39,677][pipeline:jesus][INFO] [0m[32m[valid] epoch=3 map=0.0303 [mrr@10=0.8889] ndcg@10=0.5399 ndcg@20=0.4839 p@20=0.4944 runscore_alpha=0.2875[0m
[02;37m[2020-08-20 21:18:43,224][pipeline:jesus][DEBUG] [0m[37m[train] epoch=4 loss=0.2012 acc=0.8047 unsup_acc=0.6016 delta_acc=0.2031[0m
[02;37m[2020-08-20 21:18:46,904][pipeline:jesus][INFO] [0m[32m[valid] epoch=4 map=0.0330 [mrr@10=1.0000] ndcg@10=0.5792 ndcg@20=0.5112 p@20=0.4944 runscore_alpha=0.2880[0m
[02;37m[2020-08-20 21:19:51,215][pipeline:jesus][DEBUG] [0m[37m[train] epoch=5 loss=0.2307 acc=0.7734 unsup_acc=0.5508 delta_acc=0.2227[0m
[02;37m[2020-08-20 21:19:54,936][pipeline:jesus][INFO] [0m[32m[valid] epoch=5 map=0.0324 [mrr@10=0.9444] ndcg@10=0.5674 ndcg@20=0.4974 p@20=0.4944 runscore_alpha=0.2879[0m
[02;37m[2020-08-20 21:20:59,040][pipeline:jesus][DEBUG] [0m[37m[train] epoch=6 loss=0.1876 acc=0.8125 unsup_acc=0.5762 delta_acc=0.2363[0m
[02;37m[2020-08-20 21:21:02,725][pipeline:jesus][INFO] [0m[32m[valid] epoch=6 map=0.0324 [mrr@10=0.9259] ndcg@10=0.5444 ndcg@20=0.4927 p@20=0.4944 runscore_alpha=0.2871[0m
[02;37m[2020-08-20 21:22:09,854][pipeline:jesus][DEBUG] [0m[37m[train] epoch=7 loss=0.1909 acc=0.8047 unsup_acc=0.5645 delta_acc=0.2402[0m
[02;37m[2020-08-20 21:22:13,561][pipeline:jesus][INFO] [0m[32m[valid] epoch=7 map=0.0336 [mrr@10=0.8889] ndcg@10=0.5647 ndcg@20=0.4998 p@20=0.4944 runscore_alpha=0.2879[0m
[02;37m[2020-08-20 21:23:18,621][pipeline:jesus][DEBUG] [0m[37m[train] epoch=8 loss=0.1957 acc=0.8105 unsup_acc=0.5547 delta_acc=0.2559[0m
[02;37m[2020-08-20 21:23:22,309][pipeline:jesus][INFO] [0m[32m[valid] epoch=8 map=0.0319 [mrr@10=0.8333] ndcg@10=0.5487 ndcg@20=0.4863 p@20=0.4944 runscore_alpha=0.2879[0m
[02;37m[2020-08-20 21:24:29,067][pipeline:jesus][DEBUG] [0m[37m[train] epoch=9 loss=0.1926 acc=0.8145 unsup_acc=0.5762 delta_acc=0.2383[0m
[02;37m[2020-08-20 21:24:32,767][pipeline:jesus][INFO] [0m[32m[valid] epoch=9 map=0.0335 [mrr@10=0.8889] ndcg@10=0.5645 ndcg@20=0.5001 p@20=0.4944 runscore_alpha=0.2889[0m
[02;37m[2020-08-20 21:25:40,774][pipeline:jesus][DEBUG] [0m[37m[train] epoch=10 loss=0.1803 acc=0.8242 unsup_acc=0.5918 delta_acc=0.2324[0m
[02;37m[2020-08-20 21:25:44,436][pipeline:jesus][INFO] [0m[32m[valid] epoch=10 map=0.0331 [mrr@10=0.8889] ndcg@10=0.5526 ndcg@20=0.4900 p@20=0.4944 runscore_alpha=0.2900[0m
[02;37m[2020-08-20 21:26:50,513][pipeline:jesus][DEBUG] [0m[37m[train] epoch=11 loss=0.1641 acc=0.8359 unsup_acc=0.5508 delta_acc=0.2852[0m
[02;37m[2020-08-20 21:26:54,223][pipeline:jesus][INFO] [0m[32m[valid] epoch=11 map=0.0334 [mrr@10=0.9444] ndcg@10=0.5692 ndcg@20=0.4961 p@20=0.4944 runscore_alpha=0.2893[0m
[02;37m[2020-08-20 21:28:01,473][pipeline:jesus][DEBUG] [0m[37m[train] epoch=12 loss=0.1579 acc=0.8496 unsup_acc=0.5938 delta_acc=0.2559[0m
[02;37m[2020-08-20 21:28:05,168][pipeline:jesus][INFO] [0m[32m[valid] epoch=12 map=0.0371 [mrr@10=0.9444] ndcg@10=0.5855 ndcg@20=0.5125 p@20=0.4944 runscore_alpha=0.2895[0m
[02;37m[2020-08-20 21:29:11,623][pipeline:jesus][DEBUG] [0m[37m[train] epoch=13 loss=0.1692 acc=0.8340 unsup_acc=0.5859 delta_acc=0.2480[0m
[02;37m[2020-08-20 21:29:15,347][pipeline:jesus][INFO] [0m[32m[valid] epoch=13 map=0.0374 [mrr@10=1.0000] ndcg@10=0.6106 ndcg@20=0.5219 p@20=0.4944 runscore_alpha=0.2895[0m
[02;37m[2020-08-20 21:30:20,542][pipeline:jesus][DEBUG] [0m[37m[train] epoch=14 loss=0.1511 acc=0.8516 unsup_acc=0.5664 delta_acc=0.2852[0m
[02;37m[2020-08-20 21:30:24,200][pipeline:jesus][INFO] [0m[32m[valid] epoch=14 map=0.0351 [mrr@10=1.0000] ndcg@10=0.5828 ndcg@20=0.5152 p@20=0.4944 runscore_alpha=0.2897[0m
[02;37m[2020-08-20 21:31:29,958][pipeline:jesus][DEBUG] [0m[37m[train] epoch=15 loss=0.1770 acc=0.8223 unsup_acc=0.5781 delta_acc=0.2441[0m
[02;37m[2020-08-20 21:31:33,646][pipeline:jesus][INFO] [0m[32m[valid] epoch=15 map=0.0341 [mrr@10=1.0000] ndcg@10=0.5639 ndcg@20=0.5034 p@20=0.4944 runscore_alpha=0.2903[0m
[02;37m[2020-08-20 21:32:39,078][pipeline:jesus][DEBUG] [0m[37m[train] epoch=16 loss=0.1214 acc=0.8848 unsup_acc=0.5898 delta_acc=0.2949[0m
[02;37m[2020-08-20 21:32:42,801][pipeline:jesus][INFO] [0m[32m[valid] epoch=16 map=0.0364 [mrr@10=1.0000] ndcg@10=0.5860 ndcg@20=0.5110 p@20=0.4944 runscore_alpha=0.2909[0m
[02;37m[2020-08-20 21:33:47,105][pipeline:jesus][DEBUG] [0m[37m[train] epoch=17 loss=0.1436 acc=0.8594 unsup_acc=0.5742 delta_acc=0.2852[0m
[02;37m[2020-08-20 21:33:50,770][pipeline:jesus][INFO] [0m[32m[valid] epoch=17 map=0.0359 [mrr@10=0.8889] ndcg@10=0.5933 ndcg@20=0.5030 p@20=0.4944 runscore_alpha=0.2919[0m
[02;37m[2020-08-20 21:34:57,346][pipeline:jesus][DEBUG] [0m[37m[train] epoch=18 loss=0.1752 acc=0.8184 unsup_acc=0.5352 delta_acc=0.2832[0m
[02;37m[2020-08-20 21:35:01,070][pipeline:jesus][INFO] [0m[32m[valid] epoch=18 map=0.0327 [mrr@10=0.9444] ndcg@10=0.5537 ndcg@20=0.4923 p@20=0.4944 runscore_alpha=0.2911[0m
[02;37m[2020-08-20 21:36:06,698][pipeline:jesus][DEBUG] [0m[37m[train] epoch=19 loss=0.1557 acc=0.8477 unsup_acc=0.5625 delta_acc=0.2852[0m
[02;37m[2020-08-20 21:36:10,380][pipeline:jesus][INFO] [0m[32m[valid] epoch=19 map=0.0336 [mrr@10=1.0000] ndcg@10=0.5664 ndcg@20=0.5003 p@20=0.4944 runscore_alpha=0.2914[0m
[02;37m[2020-08-20 21:37:15,863][pipeline:jesus][DEBUG] [0m[37m[train] epoch=20 loss=0.1540 acc=0.8477 unsup_acc=0.5723 delta_acc=0.2754[0m
[02;37m[2020-08-20 21:37:19,562][pipeline:jesus][INFO] [0m[32m[valid] epoch=20 map=0.0369 [mrr@10=1.0000] ndcg@10=0.5834 ndcg@20=0.5110 p@20=0.4944 runscore_alpha=0.2909[0m
[02;37m[2020-08-20 21:38:21,523][pipeline:jesus][DEBUG] [0m[37m[train] epoch=21 loss=0.1638 acc=0.8359 unsup_acc=0.5625 delta_acc=0.2734[0m
[02;37m[2020-08-20 21:38:25,224][pipeline:jesus][INFO] [0m[32m[valid] epoch=21 map=0.0369 [mrr@10=1.0000] ndcg@10=0.5815 ndcg@20=0.5052 p@20=0.4944 runscore_alpha=0.2894[0m
[02;37m[2020-08-20 21:38:25,224][pipeline:jesus][WARNING] [0m[33mstopping after epoch 21 (20 epochs with no improvement to mrr@10)[0m
[02;37m[2020-08-20 21:38:25,225][pipeline:jesus][INFO] [0m[32mtop validation epoch=1 mrr@10=1.0[0m
[02;37m[2020-08-20 21:38:25,225][pipeline:jesus][INFO] [0m[32m[jesus: top_train_ctxt] {'epoch': 1, 'batch_size': 16, 'batches_per_epoch': 32, 'num_microbatches': 16, 'device': device(type='cuda'), 'base_path': '../data/models/config1/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config1_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs', 'ranker': <function Trainer.iter_train.<locals>.<lambda> at 0x7fe98b8a3c80>, 'ranker_path': '../data/models/config1/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config1_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/weights/1.p', 'optimizer': <function Trainer.iter_train.<locals>.<lambda> at 0x7fe984095400>, 'optimizer_path': '../data/models/config1/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config1_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/optimizer/1.p', 'loss': 0.23468084773048759, 'losses': {'data': 0.23468084773048759}, 'acc': 0.767578125, 'unsup_acc': 0.541015625, 'cached': False}[0m
[02;37m[2020-08-20 21:38:31,810][pipeline:jesus][INFO] [0m[32mvalid run at ../data/models/config1/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config1_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/covid_vaf2-rnd5-quest_bm25_k1-3.9_b-0.55.20_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/runs/21.run[0m
[02;37m[2020-08-20 21:38:31,812][pipeline:jesus][INFO] [0m[32mvalid epoch=1 map=0.0325 [mrr@10=1.0000] ndcg@10=0.5726 ndcg@20=0.5027 p@20=0.4944 runscore_alpha=0.2858[0m
