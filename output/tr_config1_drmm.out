Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex.
[02;37m[2020-08-18 18:28:13,798][vocab:wordvec_hash][DEBUG] [0m[37m[starting] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p[0m
[02;37m[2020-08-18 18:28:20,766][vocab:wordvec_hash][DEBUG] [0m[37m[finished] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p [6.97s][0m
[02;37m[2020-08-18 18:28:35,350][trainer:pairwise][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-18 18:28:35,388][onir.injector][DEBUG] [0m[37mConfiguration:[0m
 vocab      wordvec_hash                                                  
--------------------------------------------------------------------------
 source     [33mglove[0m         |  variant      [33mcc-42b-300d[0m  |  train     False 
 hashspace  1000          |  init_stddev  0.5          |  log_miss  False 

 train_ds  covid                                                                  
----------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mtrf2-rnd5-quest[0m  |  ranktopk  1000 
 date      2020-07-16          |  2020_filter  [33mTrue[0m             |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m       |  fold      all  

 ranker   drmm                                            
----------------------------------------------------------
 qlen     [33m40[0m    |  dlen   2000  |  add_runscore  [33mTrue[0m     
 hidden   5     |  nbins  11    |  histo         logcount 
 combine  idf                                             

 trainer     pairwise                                                                                                    
-------------------------------------------------------------------------------------------------------------------------
 batch_size  16        |  batches_per_epoch  32         |  grad_acc_batch  0                                             
 optimizer   adam      |  lr                 0.001      |  gpu             True                                          
 gpu_determ  True      |  encoder_lr         0.0        |  pipeline        [33mmsmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m 
 lossfn      softmax   |  pos_source         intersect  |  neg_source      run                                           
 sampling    query     |  pos_minrel         1          |  unjudged_rel    0                                             
 num_neg     1         |  margin             0.0                                                                         

 valid_ds  covid                                                                  
----------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mvaf2-rnd5-quest[0m  |  ranktopk  [33m20[0m   
 date      2020-07-16          |  2020_filter  [33mTrue[0m             |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m       |  fold      all  

 valid_pred  reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 test_ds   covid                                                                
--------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mf2-rnd5-quest[0m  |  ranktopk  [33m500[0m  
 date      2020-07-16          |  2020_filter  [33mTrue[0m           |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m     |  fold      all  

 test_pred   reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 pipeline      jesus                                                  
----------------------------------------------------------------------
 max_epoch     1000    |  early_stop     20     |  warmup       -1    
 val_metric    [33mmrr@10[0m  |  purge_weights  True   |  test         False 
 initial_eval  False   |  skip_ds_init   False  |  only_cached  False 
 onlytest      False   |  finetune       [33mTrue[0m   |  savefile     _     
[0m
[02;37m[2020-08-18 18:28:35,388][valid_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-18 18:28:35,390][trainer:pairwise][INFO] [0m[32mtrain path: ../data/models/config1/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m
[02;37m[2020-08-18 18:28:38,323][trainer:pairwise][INFO] [0m[32mloading prev model : ../data/models/config1/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m
[02;37m[2020-08-18 18:28:38,359][train_ds:covid][DEBUG] [0m[37m[starting] reading bm25_k1-3.9_b-0.55:1000[0m
[02;37m[2020-08-18 18:28:38,396][train_ds:covid][DEBUG] [0m[37m[finished] reading bm25_k1-3.9_b-0.55:1000 [37ms][0m
[02;37m[2020-08-18 18:28:39,265][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=0 loss=0.4239 acc=0.6387 unsup_acc=0.6113 delta_acc=0.0273[0m
[02;37m[2020-08-18 18:28:39,269][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=0 map=0.0320 [mrr@10=0.7593] ndcg@10=0.5039 ndcg@20=0.4727 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:28:40,094][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=1 loss=0.4153 acc=0.6523 unsup_acc=0.6074 delta_acc=0.0449[0m
[02;37m[2020-08-18 18:28:40,097][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=1 map=0.0317 [mrr@10=0.7778] ndcg@10=0.5239 ndcg@20=0.4807 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:28:40,915][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=2 loss=0.4081 acc=0.6719 unsup_acc=0.5996 delta_acc=0.0723[0m
[02;37m[2020-08-18 18:28:40,919][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=2 map=0.0314 [mrr@10=0.7778] ndcg@10=0.5117 ndcg@20=0.4815 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:41,740][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=3 loss=0.3807 acc=0.6934 unsup_acc=0.6328 delta_acc=0.0605[0m
[02;37m[2020-08-18 18:28:41,744][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=3 map=0.0306 [mrr@10=0.7778] ndcg@10=0.4984 ndcg@20=0.4791 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:42,564][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=4 loss=0.3589 acc=0.7051 unsup_acc=0.6602 delta_acc=0.0449[0m
[02;37m[2020-08-18 18:28:42,566][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=4 map=0.0307 [mrr@10=0.7870] ndcg@10=0.5031 ndcg@20=0.4819 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:28:43,393][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=5 loss=0.3934 acc=0.6445 unsup_acc=0.6289 delta_acc=0.0156[0m
[02;37m[2020-08-18 18:28:43,396][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=5 map=0.0307 [mrr@10=0.8056] ndcg@10=0.5050 ndcg@20=0.4829 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:28:44,227][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=6 loss=0.3791 acc=0.6582 unsup_acc=0.6250 delta_acc=0.0332[0m
[02;37m[2020-08-18 18:28:44,229][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=6 map=0.0304 [mrr@10=0.8056] ndcg@10=0.5057 ndcg@20=0.4834 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:45,057][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=7 loss=0.3930 acc=0.6523 unsup_acc=0.6191 delta_acc=0.0332[0m
[02;37m[2020-08-18 18:28:45,059][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=7 map=0.0303 [mrr@10=0.8056] ndcg@10=0.5021 ndcg@20=0.4809 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:45,887][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=8 loss=0.3609 acc=0.6836 unsup_acc=0.6465 delta_acc=0.0371[0m
[02;37m[2020-08-18 18:28:45,891][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=8 map=0.0303 [mrr@10=0.8056] ndcg@10=0.4999 ndcg@20=0.4796 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:46,730][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=9 loss=0.3684 acc=0.6562 unsup_acc=0.6289 delta_acc=0.0273[0m
[02;37m[2020-08-18 18:28:46,734][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=9 map=0.0302 [mrr@10=0.8056] ndcg@10=0.4920 ndcg@20=0.4787 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:47,570][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=10 loss=0.3679 acc=0.6699 unsup_acc=0.6387 delta_acc=0.0312[0m
[02;37m[2020-08-18 18:28:47,574][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=10 map=0.0301 [mrr@10=0.8056] ndcg@10=0.4910 ndcg@20=0.4780 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:48,404][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=11 loss=0.3659 acc=0.6797 unsup_acc=0.6055 delta_acc=0.0742[0m
[02;37m[2020-08-18 18:28:48,408][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=11 map=0.0300 [mrr@10=0.8056] ndcg@10=0.4898 ndcg@20=0.4772 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:49,226][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=12 loss=0.3541 acc=0.6836 unsup_acc=0.6230 delta_acc=0.0605[0m
[02;37m[2020-08-18 18:28:49,229][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=12 map=0.0301 [mrr@10=0.8148] ndcg@10=0.4923 ndcg@20=0.4787 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:28:50,048][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=13 loss=0.3712 acc=0.6641 unsup_acc=0.6348 delta_acc=0.0293[0m
[02;37m[2020-08-18 18:28:50,051][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=13 map=0.0302 [mrr@10=0.8148] ndcg@10=0.4936 ndcg@20=0.4797 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:50,867][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=14 loss=0.3572 acc=0.6855 unsup_acc=0.6113 delta_acc=0.0742[0m
[02;37m[2020-08-18 18:28:50,870][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=14 map=0.0301 [mrr@10=0.8148] ndcg@10=0.4858 ndcg@20=0.4790 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:51,676][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=15 loss=0.3583 acc=0.6699 unsup_acc=0.6172 delta_acc=0.0527[0m
[02;37m[2020-08-18 18:28:51,678][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=15 map=0.0302 [mrr@10=0.8148] ndcg@10=0.4931 ndcg@20=0.4794 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:52,498][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=16 loss=0.3635 acc=0.6621 unsup_acc=0.6230 delta_acc=0.0391[0m
[02;37m[2020-08-18 18:28:52,500][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=16 map=0.0301 [mrr@10=0.8148] ndcg@10=0.4853 ndcg@20=0.4788 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:53,318][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=17 loss=0.3826 acc=0.6465 unsup_acc=0.6406 delta_acc=0.0059[0m
[02;37m[2020-08-18 18:28:53,322][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=17 map=0.0302 [mrr@10=0.8148] ndcg@10=0.4858 ndcg@20=0.4788 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:54,138][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=18 loss=0.3451 acc=0.6973 unsup_acc=0.6348 delta_acc=0.0625[0m
[02;37m[2020-08-18 18:28:54,141][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=18 map=0.0299 [mrr@10=0.8148] ndcg@10=0.4822 ndcg@20=0.4765 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:54,956][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=19 loss=0.3736 acc=0.6680 unsup_acc=0.6191 delta_acc=0.0488[0m
[02;37m[2020-08-18 18:28:54,959][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=19 map=0.0299 [mrr@10=0.8148] ndcg@10=0.4822 ndcg@20=0.4768 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:55,775][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=20 loss=0.3553 acc=0.6641 unsup_acc=0.6055 delta_acc=0.0586[0m
[02;37m[2020-08-18 18:28:55,779][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=20 map=0.0299 [mrr@10=0.8148] ndcg@10=0.4822 ndcg@20=0.4767 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:56,612][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=21 loss=0.3762 acc=0.6504 unsup_acc=0.6270 delta_acc=0.0234[0m
[02;37m[2020-08-18 18:28:56,617][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=21 map=0.0299 [mrr@10=0.8148] ndcg@10=0.4812 ndcg@20=0.4761 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:57,438][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=22 loss=0.3477 acc=0.6914 unsup_acc=0.6445 delta_acc=0.0469[0m
[02;37m[2020-08-18 18:28:57,440][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=22 map=0.0299 [mrr@10=0.8148] ndcg@10=0.4812 ndcg@20=0.4761 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:58,260][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=23 loss=0.3440 acc=0.6816 unsup_acc=0.6035 delta_acc=0.0781[0m
[02;37m[2020-08-18 18:28:58,263][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=23 map=0.0299 [mrr@10=0.8148] ndcg@10=0.4812 ndcg@20=0.4761 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:59,081][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=24 loss=0.3622 acc=0.6582 unsup_acc=0.6680 delta_acc=-0.0098[0m
[02;37m[2020-08-18 18:28:59,084][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=24 map=0.0296 [mrr@10=0.8148] ndcg@10=0.4715 ndcg@20=0.4744 p@20=0.4944[0m
[02;37m[2020-08-18 18:28:59,899][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=25 loss=0.3819 acc=0.6289 unsup_acc=0.5957 delta_acc=0.0332[0m
[02;37m[2020-08-18 18:28:59,902][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=25 map=0.0296 [mrr@10=0.8148] ndcg@10=0.4780 ndcg@20=0.4743 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:00,721][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=26 loss=0.3533 acc=0.6758 unsup_acc=0.6465 delta_acc=0.0293[0m
[02;37m[2020-08-18 18:29:00,727][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=26 map=0.0297 [mrr@10=0.8148] ndcg@10=0.4798 ndcg@20=0.4748 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:01,546][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=27 loss=0.3503 acc=0.6797 unsup_acc=0.6523 delta_acc=0.0273[0m
[02;37m[2020-08-18 18:29:01,549][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=27 map=0.0297 [mrr@10=0.8148] ndcg@10=0.4798 ndcg@20=0.4748 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:02,367][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=28 loss=0.3449 acc=0.6855 unsup_acc=0.6016 delta_acc=0.0840[0m
[02;37m[2020-08-18 18:29:02,370][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=28 map=0.0297 [mrr@10=0.8333] ndcg@10=0.4807 ndcg@20=0.4754 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:29:03,185][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=29 loss=0.3379 acc=0.6875 unsup_acc=0.6387 delta_acc=0.0488[0m
[02;37m[2020-08-18 18:29:03,192][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=29 map=0.0296 [mrr@10=0.8333] ndcg@10=0.4801 ndcg@20=0.4751 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:04,004][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=30 loss=0.3555 acc=0.6660 unsup_acc=0.6328 delta_acc=0.0332[0m
[02;37m[2020-08-18 18:29:04,007][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=30 map=0.0300 [mrr@10=0.8333] ndcg@10=0.4828 ndcg@20=0.4768 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:04,826][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=31 loss=0.3688 acc=0.6426 unsup_acc=0.6387 delta_acc=0.0039[0m
[02;37m[2020-08-18 18:29:04,828][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=31 map=0.0296 [mrr@10=0.8333] ndcg@10=0.4795 ndcg@20=0.4746 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:05,653][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=32 loss=0.3537 acc=0.6758 unsup_acc=0.6738 delta_acc=0.0020[0m
[02;37m[2020-08-18 18:29:05,655][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=32 map=0.0297 [mrr@10=0.8333] ndcg@10=0.4807 ndcg@20=0.4754 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:06,483][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=33 loss=0.3378 acc=0.6758 unsup_acc=0.6582 delta_acc=0.0176[0m
[02;37m[2020-08-18 18:29:06,486][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=33 map=0.0296 [mrr@10=0.8333] ndcg@10=0.4780 ndcg@20=0.4737 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:07,322][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=34 loss=0.3691 acc=0.6465 unsup_acc=0.6582 delta_acc=-0.0117[0m
[02;37m[2020-08-18 18:29:07,324][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=34 map=0.0296 [mrr@10=0.8333] ndcg@10=0.4770 ndcg@20=0.4731 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:08,151][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=35 loss=0.3468 acc=0.6719 unsup_acc=0.6016 delta_acc=0.0703[0m
[02;37m[2020-08-18 18:29:08,153][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=35 map=0.0295 [mrr@10=0.8333] ndcg@10=0.4770 ndcg@20=0.4730 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:08,983][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=36 loss=0.3302 acc=0.7090 unsup_acc=0.6934 delta_acc=0.0156[0m
[02;37m[2020-08-18 18:29:08,988][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=36 map=0.0295 [mrr@10=0.8333] ndcg@10=0.4765 ndcg@20=0.4726 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:09,820][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=37 loss=0.3670 acc=0.6602 unsup_acc=0.5898 delta_acc=0.0703[0m
[02;37m[2020-08-18 18:29:09,825][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=37 map=0.0294 [mrr@10=0.8333] ndcg@10=0.4747 ndcg@20=0.4714 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:10,658][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=38 loss=0.3805 acc=0.6406 unsup_acc=0.5977 delta_acc=0.0430[0m
[02;37m[2020-08-18 18:29:10,663][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=38 map=0.0294 [mrr@10=0.8333] ndcg@10=0.4754 ndcg@20=0.4719 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:11,495][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=39 loss=0.3349 acc=0.6992 unsup_acc=0.6504 delta_acc=0.0488[0m
[02;37m[2020-08-18 18:29:11,500][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=39 map=0.0294 [mrr@10=0.8333] ndcg@10=0.4750 ndcg@20=0.4716 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:12,329][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=40 loss=0.3270 acc=0.6992 unsup_acc=0.6699 delta_acc=0.0293[0m
[02;37m[2020-08-18 18:29:12,335][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=40 map=0.0294 [mrr@10=0.8333] ndcg@10=0.4745 ndcg@20=0.4714 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:13,168][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=41 loss=0.3552 acc=0.6602 unsup_acc=0.6250 delta_acc=0.0352[0m
[02;37m[2020-08-18 18:29:13,170][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=41 map=0.0293 [mrr@10=0.8333] ndcg@10=0.4745 ndcg@20=0.4712 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:13,999][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=42 loss=0.3643 acc=0.6621 unsup_acc=0.6074 delta_acc=0.0547[0m
[02;37m[2020-08-18 18:29:14,001][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=42 map=0.0293 [mrr@10=0.8333] ndcg@10=0.4745 ndcg@20=0.4711 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:14,833][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=43 loss=0.3341 acc=0.6953 unsup_acc=0.6113 delta_acc=0.0840[0m
[02;37m[2020-08-18 18:29:14,835][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=43 map=0.0302 [mrr@10=0.8889] ndcg@10=0.4846 ndcg@20=0.4778 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:29:15,657][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=44 loss=0.3193 acc=0.6914 unsup_acc=0.5859 delta_acc=0.1055[0m
[02;37m[2020-08-18 18:29:15,660][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=44 map=0.0300 [mrr@10=0.8889] ndcg@10=0.4760 ndcg@20=0.4723 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:16,482][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=45 loss=0.3413 acc=0.6797 unsup_acc=0.6660 delta_acc=0.0137[0m
[02;37m[2020-08-18 18:29:16,484][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=45 map=0.0300 [mrr@10=0.8889] ndcg@10=0.4764 ndcg@20=0.4724 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:17,320][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=46 loss=0.3639 acc=0.6523 unsup_acc=0.6016 delta_acc=0.0508[0m
[02;37m[2020-08-18 18:29:17,322][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=46 map=0.0300 [mrr@10=0.8889] ndcg@10=0.4767 ndcg@20=0.4728 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:18,146][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=47 loss=0.3481 acc=0.6816 unsup_acc=0.6191 delta_acc=0.0625[0m
[02;37m[2020-08-18 18:29:18,152][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=47 map=0.0302 [mrr@10=0.9444] ndcg@10=0.4934 ndcg@20=0.4835 p@20=0.4944 runscore_alpha=0.3301 <---[0m
[02;37m[2020-08-18 18:29:18,982][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=48 loss=0.3392 acc=0.6816 unsup_acc=0.6113 delta_acc=0.0703[0m
[02;37m[2020-08-18 18:29:18,984][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=48 map=0.0291 [mrr@10=0.9444] ndcg@10=0.4753 ndcg@20=0.4717 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:19,811][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=49 loss=0.3391 acc=0.6738 unsup_acc=0.6699 delta_acc=0.0039[0m
[02;37m[2020-08-18 18:29:19,814][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=49 map=0.0291 [mrr@10=0.9444] ndcg@10=0.4742 ndcg@20=0.4711 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:20,637][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=50 loss=0.3257 acc=0.7070 unsup_acc=0.5938 delta_acc=0.1133[0m
[02;37m[2020-08-18 18:29:20,639][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=50 map=0.0291 [mrr@10=0.9444] ndcg@10=0.4742 ndcg@20=0.4708 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:21,468][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=51 loss=0.3464 acc=0.6562 unsup_acc=0.6348 delta_acc=0.0215[0m
[02;37m[2020-08-18 18:29:21,471][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=51 map=0.0291 [mrr@10=0.9444] ndcg@10=0.4742 ndcg@20=0.4708 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:22,297][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=52 loss=0.3321 acc=0.6816 unsup_acc=0.6250 delta_acc=0.0566[0m
[02;37m[2020-08-18 18:29:22,299][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=52 map=0.0290 [mrr@10=0.9444] ndcg@10=0.4737 ndcg@20=0.4706 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:23,124][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=53 loss=0.3473 acc=0.6758 unsup_acc=0.6211 delta_acc=0.0547[0m
[02;37m[2020-08-18 18:29:23,127][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=53 map=0.0290 [mrr@10=0.9444] ndcg@10=0.4736 ndcg@20=0.4706 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:23,957][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=54 loss=0.3548 acc=0.6719 unsup_acc=0.5898 delta_acc=0.0820[0m
[02;37m[2020-08-18 18:29:23,960][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=54 map=0.0290 [mrr@10=0.9259] ndcg@10=0.4698 ndcg@20=0.4682 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:24,786][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=55 loss=0.3189 acc=0.6895 unsup_acc=0.6426 delta_acc=0.0469[0m
[02;37m[2020-08-18 18:29:24,788][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=55 map=0.0292 [mrr@10=0.9259] ndcg@10=0.4711 ndcg@20=0.4691 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:25,616][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=56 loss=0.3591 acc=0.6504 unsup_acc=0.6523 delta_acc=-0.0020[0m
[02;37m[2020-08-18 18:29:25,618][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=56 map=0.0290 [mrr@10=0.9259] ndcg@10=0.4718 ndcg@20=0.4693 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:26,439][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=57 loss=0.3231 acc=0.6953 unsup_acc=0.6484 delta_acc=0.0469[0m
[02;37m[2020-08-18 18:29:26,441][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=57 map=0.0291 [mrr@10=0.9259] ndcg@10=0.4722 ndcg@20=0.4695 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:27,275][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=58 loss=0.3247 acc=0.6855 unsup_acc=0.6387 delta_acc=0.0469[0m
[02;37m[2020-08-18 18:29:27,277][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=58 map=0.0290 [mrr@10=0.9259] ndcg@10=0.4718 ndcg@20=0.4693 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:28,098][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=59 loss=0.3859 acc=0.6328 unsup_acc=0.5977 delta_acc=0.0352[0m
[02;37m[2020-08-18 18:29:28,100][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=59 map=0.0291 [mrr@10=0.9259] ndcg@10=0.4711 ndcg@20=0.4689 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:28,925][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=60 loss=0.3633 acc=0.6543 unsup_acc=0.6211 delta_acc=0.0332[0m
[02;37m[2020-08-18 18:29:28,929][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=60 map=0.0293 [mrr@10=0.9259] ndcg@10=0.4716 ndcg@20=0.4696 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:29,754][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=61 loss=0.3291 acc=0.6934 unsup_acc=0.6074 delta_acc=0.0859[0m
[02;37m[2020-08-18 18:29:29,758][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=61 map=0.0289 [mrr@10=0.9259] ndcg@10=0.4620 ndcg@20=0.4631 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:30,584][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=62 loss=0.3435 acc=0.6816 unsup_acc=0.6367 delta_acc=0.0449[0m
[02;37m[2020-08-18 18:29:30,587][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=62 map=0.0290 [mrr@10=0.9259] ndcg@10=0.4705 ndcg@20=0.4686 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:31,408][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=63 loss=0.3467 acc=0.6777 unsup_acc=0.6426 delta_acc=0.0352[0m
[02;37m[2020-08-18 18:29:31,413][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=63 map=0.0286 [mrr@10=0.9259] ndcg@10=0.4663 ndcg@20=0.4657 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:32,229][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=64 loss=0.3062 acc=0.7266 unsup_acc=0.6602 delta_acc=0.0664[0m
[02;37m[2020-08-18 18:29:32,235][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=64 map=0.0287 [mrr@10=0.9259] ndcg@10=0.4674 ndcg@20=0.4664 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:33,061][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=65 loss=0.3524 acc=0.6582 unsup_acc=0.6484 delta_acc=0.0098[0m
[02;37m[2020-08-18 18:29:33,065][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=65 map=0.0288 [mrr@10=0.9259] ndcg@10=0.4597 ndcg@20=0.4659 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:33,890][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=66 loss=0.3399 acc=0.6641 unsup_acc=0.5957 delta_acc=0.0684[0m
[02;37m[2020-08-18 18:29:33,894][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=66 map=0.0289 [mrr@10=0.9259] ndcg@10=0.4620 ndcg@20=0.4629 p@20=0.4944[0m
[02;37m[2020-08-18 18:29:34,718][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=67 loss=0.3139 acc=0.7070 unsup_acc=0.6387 delta_acc=0.0684[0m
[02;37m[2020-08-18 18:29:34,724][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=67 map=0.0287 [mrr@10=0.9259] ndcg@10=0.4607 ndcg@20=0.4622 p@20=0.4944 runscore_alpha=0.3416[0m
[02;37m[2020-08-18 18:29:34,724][pipeline:jesus][WARNING] [0m[33mstopping after epoch 67 (20 epochs with no improvement to mrr@10)[0m
[02;37m[2020-08-18 18:29:34,725][pipeline:jesus][INFO] [0m[32mtop validation epoch=47 mrr@10=0.9444444444444444[0m
[02;37m[2020-08-18 18:29:34,725][pipeline:jesus][INFO] [0m[32m[jesus: top_train_ctxt] {'epoch': 47, 'batch_size': 16, 'batches_per_epoch': 32, 'num_microbatches': 1, 'device': device(type='cuda'), 'base_path': '../data/models/config1/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs', 'ranker': <function _load_ranker.<locals>._wrapped at 0x7f50ad0d0158>, 'ranker_path': '../data/models/config1/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/weights/47.p', 'optimizer': <function _load_optimizer.<locals>._wrapped at 0x7f50ad0d00d0>, 'optimizer_path': '../data/models/config1/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/optimizer/47.p', 'loss': 0.34811783116310835, 'data_loss': -999, 'losses': {}, 'acc': 0.681640625, 'unsup_acc': 0.619140625, 'cached': True}[0m
[02;37m[2020-08-18 18:29:34,725][pipeline:jesus][INFO] [0m[32mvalid run at ../data/models/config1/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/covid_vaf2-rnd5-quest_bm25_k1-3.9_b-0.55.20_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/runs/67.run[0m
[02;37m[2020-08-18 18:29:34,726][pipeline:jesus][INFO] [0m[32mvalid epoch=47 map=0.0302 [mrr@10=0.9444] ndcg@10=0.4934 ndcg@20=0.4835 p@20=0.4944 runscore_alpha=0.3301[0m
