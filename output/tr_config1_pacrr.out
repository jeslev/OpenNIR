Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex.
[02;37m[2020-08-18 18:12:55,827][vocab:wordvec_hash][DEBUG] [0m[37m[starting] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p[0m
[02;37m[2020-08-18 18:13:03,933][vocab:wordvec_hash][DEBUG] [0m[37m[finished] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p [8.11s][0m
[02;37m[2020-08-18 18:13:10,631][trainer:pairwise][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-18 18:13:10,641][onir.injector][DEBUG] [0m[37mConfiguration:[0m
 vocab      wordvec_hash                                                  
--------------------------------------------------------------------------
 source     [33mglove[0m         |  variant      [33mcc-42b-300d[0m  |  train     False 
 hashspace  1000          |  init_stddev  0.5          |  log_miss  False 

 train_ds  covid                                                                  
----------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mtrf2-rnd5-quest[0m  |  ranktopk  1000 
 date      2020-07-16          |  2020_filter  [33mTrue[0m             |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m       |  fold      all  

 ranker   pacrr                                             
------------------------------------------------------------
 qlen     [33m40[0m       |  dlen     2000  |  add_runscore  [33mTrue[0m  
 mingram  1        |  maxgram  3     |  nfilters      32    
 idf      True     |  kmax     2     |  shuf          False 
 combine  dense32                                           

 trainer     pairwise                                                                                                    
-------------------------------------------------------------------------------------------------------------------------
 batch_size  16        |  batches_per_epoch  32         |  grad_acc_batch  0                                             
 optimizer   adam      |  lr                 0.001      |  gpu             True                                          
 gpu_determ  True      |  encoder_lr         0.0        |  pipeline        [33mmsmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m 
 lossfn      softmax   |  pos_source         intersect  |  neg_source      run                                           
 sampling    query     |  pos_minrel         1          |  unjudged_rel    0                                             
 num_neg     1         |  margin             0.0                                                                         

 valid_ds  covid                                                                  
----------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mvaf2-rnd5-quest[0m  |  ranktopk  [33m20[0m   
 date      2020-07-16          |  2020_filter  [33mTrue[0m             |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m       |  fold      all  

 valid_pred  reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 test_ds   covid                                                                
--------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mf2-rnd5-quest[0m  |  ranktopk  [33m500[0m  
 date      2020-07-16          |  2020_filter  [33mTrue[0m           |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m     |  fold      all  

 test_pred   reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 pipeline      jesus                                                  
----------------------------------------------------------------------
 max_epoch     1000    |  early_stop     20     |  warmup       -1    
 val_metric    [33mmrr@10[0m  |  purge_weights  True   |  test         False 
 initial_eval  False   |  skip_ds_init   False  |  only_cached  False 
 onlytest      False   |  finetune       [33mTrue[0m   |  savefile     _     
[0m
[02;37m[2020-08-18 18:13:10,641][valid_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-18 18:13:10,643][trainer:pairwise][INFO] [0m[32mtrain path: ../data/models/config1/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m
[02;37m[2020-08-18 18:13:13,525][trainer:pairwise][INFO] [0m[32mloading prev model : ../data/models/config1/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m
[02;37m[2020-08-18 18:13:13,560][train_ds:covid][DEBUG] [0m[37m[starting] reading bm25_k1-3.9_b-0.55:1000[0m
[02;37m[2020-08-18 18:13:13,601][train_ds:covid][DEBUG] [0m[37m[finished] reading bm25_k1-3.9_b-0.55:1000 [41ms][0m
[02;37m[2020-08-18 18:13:14,479][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=0 loss=0.3752 acc=0.6719 unsup_acc=0.6113 delta_acc=0.0605[0m
[02;37m[2020-08-18 18:13:14,481][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=0 map=0.0276 [mrr@10=0.7500] ndcg@10=0.4537 ndcg@20=0.4511 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:13:15,298][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=1 loss=0.3383 acc=0.7148 unsup_acc=0.6074 delta_acc=0.1074[0m
[02;37m[2020-08-18 18:13:15,299][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=1 map=0.0277 [mrr@10=0.7870] ndcg@10=0.4663 ndcg@20=0.4552 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:13:16,123][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=2 loss=0.3425 acc=0.6895 unsup_acc=0.5996 delta_acc=0.0898[0m
[02;37m[2020-08-18 18:13:16,127][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=2 map=0.0271 [mrr@10=0.7870] ndcg@10=0.4685 ndcg@20=0.4504 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:16,951][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=3 loss=0.3014 acc=0.7168 unsup_acc=0.6328 delta_acc=0.0840[0m
[02;37m[2020-08-18 18:13:16,953][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=3 map=0.0271 [mrr@10=0.8056] ndcg@10=0.4752 ndcg@20=0.4544 p@20=0.4944 <---[0m
[02;37m[2020-08-18 18:13:17,772][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=4 loss=0.2686 acc=0.7578 unsup_acc=0.6602 delta_acc=0.0977[0m
[02;37m[2020-08-18 18:13:17,776][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=4 map=0.0277 [mrr@10=0.8611] ndcg@10=0.4801 ndcg@20=0.4577 p@20=0.4944 runscore_alpha=0.2574 <---[0m
[02;37m[2020-08-18 18:13:18,607][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=5 loss=0.3148 acc=0.7051 unsup_acc=0.6289 delta_acc=0.0762[0m
[02;37m[2020-08-18 18:13:18,608][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=5 map=0.0276 [mrr@10=0.8611] ndcg@10=0.4797 ndcg@20=0.4574 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:19,437][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=6 loss=0.3172 acc=0.6934 unsup_acc=0.6250 delta_acc=0.0684[0m
[02;37m[2020-08-18 18:13:19,439][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=6 map=0.0268 [mrr@10=0.7500] ndcg@10=0.4666 ndcg@20=0.4511 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:20,259][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=7 loss=0.3223 acc=0.6992 unsup_acc=0.6191 delta_acc=0.0801[0m
[02;37m[2020-08-18 18:13:20,261][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=7 map=0.0268 [mrr@10=0.7500] ndcg@10=0.4645 ndcg@20=0.4499 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:21,086][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=8 loss=0.2962 acc=0.7109 unsup_acc=0.6465 delta_acc=0.0645[0m
[02;37m[2020-08-18 18:13:21,088][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=8 map=0.0277 [mrr@10=0.8056] ndcg@10=0.4758 ndcg@20=0.4573 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:21,911][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=9 loss=0.2865 acc=0.7266 unsup_acc=0.6289 delta_acc=0.0977[0m
[02;37m[2020-08-18 18:13:21,912][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=9 map=0.0269 [mrr@10=0.7500] ndcg@10=0.4653 ndcg@20=0.4504 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:22,720][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=10 loss=0.3163 acc=0.6836 unsup_acc=0.6387 delta_acc=0.0449[0m
[02;37m[2020-08-18 18:13:22,721][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=10 map=0.0270 [mrr@10=0.6944] ndcg@10=0.4519 ndcg@20=0.4463 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:23,544][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=11 loss=0.2901 acc=0.7168 unsup_acc=0.6055 delta_acc=0.1113[0m
[02;37m[2020-08-18 18:13:23,546][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=11 map=0.0271 [mrr@10=0.7500] ndcg@10=0.4677 ndcg@20=0.4521 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:24,367][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=12 loss=0.2840 acc=0.7227 unsup_acc=0.6230 delta_acc=0.0996[0m
[02;37m[2020-08-18 18:13:24,368][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=12 map=0.0271 [mrr@10=0.7500] ndcg@10=0.4664 ndcg@20=0.4511 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:25,190][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=13 loss=0.2745 acc=0.7422 unsup_acc=0.6348 delta_acc=0.1074[0m
[02;37m[2020-08-18 18:13:25,191][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=13 map=0.0270 [mrr@10=0.6944] ndcg@10=0.4581 ndcg@20=0.4458 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:26,012][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=14 loss=0.2798 acc=0.7266 unsup_acc=0.6113 delta_acc=0.1152[0m
[02;37m[2020-08-18 18:13:26,013][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=14 map=0.0278 [mrr@10=0.7500] ndcg@10=0.4689 ndcg@20=0.4529 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:26,834][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=15 loss=0.2883 acc=0.7168 unsup_acc=0.6172 delta_acc=0.0996[0m
[02;37m[2020-08-18 18:13:26,836][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=15 map=0.0279 [mrr@10=0.7500] ndcg@10=0.4775 ndcg@20=0.4538 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:27,652][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=16 loss=0.2848 acc=0.7246 unsup_acc=0.6230 delta_acc=0.1016[0m
[02;37m[2020-08-18 18:13:27,653][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=16 map=0.0280 [mrr@10=0.7500] ndcg@10=0.4771 ndcg@20=0.4536 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:28,476][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=17 loss=0.3229 acc=0.6777 unsup_acc=0.6406 delta_acc=0.0371[0m
[02;37m[2020-08-18 18:13:28,478][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=17 map=0.0277 [mrr@10=0.7500] ndcg@10=0.4687 ndcg@20=0.4522 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:29,282][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=18 loss=0.2647 acc=0.7520 unsup_acc=0.6348 delta_acc=0.1172[0m
[02;37m[2020-08-18 18:13:29,283][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=18 map=0.0271 [mrr@10=0.6759] ndcg@10=0.4600 ndcg@20=0.4472 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:30,067][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=19 loss=0.2934 acc=0.7129 unsup_acc=0.6191 delta_acc=0.0938[0m
[02;37m[2020-08-18 18:13:30,069][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=19 map=0.0272 [mrr@10=0.6944] ndcg@10=0.4622 ndcg@20=0.4483 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:30,886][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=20 loss=0.3049 acc=0.6992 unsup_acc=0.6055 delta_acc=0.0938[0m
[02;37m[2020-08-18 18:13:30,888][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=20 map=0.0273 [mrr@10=0.6944] ndcg@10=0.4698 ndcg@20=0.4487 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:31,721][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=21 loss=0.3223 acc=0.6836 unsup_acc=0.6270 delta_acc=0.0566[0m
[02;37m[2020-08-18 18:13:31,722][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=21 map=0.0269 [mrr@10=0.6204] ndcg@10=0.4484 ndcg@20=0.4393 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:32,545][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=22 loss=0.2609 acc=0.7500 unsup_acc=0.6445 delta_acc=0.1055[0m
[02;37m[2020-08-18 18:13:32,547][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=22 map=0.0269 [mrr@10=0.6204] ndcg@10=0.4505 ndcg@20=0.4404 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:33,369][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=23 loss=0.2528 acc=0.7480 unsup_acc=0.6035 delta_acc=0.1445[0m
[02;37m[2020-08-18 18:13:33,371][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=23 map=0.0275 [mrr@10=0.6389] ndcg@10=0.4582 ndcg@20=0.4454 p@20=0.4944[0m
[02;37m[2020-08-18 18:13:34,202][pipeline:jesus][DEBUG] [0m[37m[train] [cached] epoch=24 loss=0.2948 acc=0.7109 unsup_acc=0.6680 delta_acc=0.0430[0m
[02;37m[2020-08-18 18:13:34,208][pipeline:jesus][DEBUG] [0m[37m[valid] [cached] epoch=24 map=0.0272 [mrr@10=0.6204] ndcg@10=0.4548 ndcg@20=0.4435 p@20=0.4944 runscore_alpha=0.2800[0m
[02;37m[2020-08-18 18:13:34,208][pipeline:jesus][WARNING] [0m[33mstopping after epoch 24 (20 epochs with no improvement to mrr@10)[0m
[02;37m[2020-08-18 18:13:34,208][pipeline:jesus][INFO] [0m[32mtop validation epoch=4 mrr@10=0.8611111111111112[0m
[02;37m[2020-08-18 18:13:34,208][pipeline:jesus][INFO] [0m[32m[jesus: top_train_ctxt] {'epoch': 4, 'batch_size': 16, 'batches_per_epoch': 32, 'num_microbatches': 1, 'device': device(type='cuda'), 'base_path': '../data/models/config1/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs', 'ranker': <function _load_ranker.<locals>._wrapped at 0x7f2a7a363b70>, 'ranker_path': '../data/models/config1/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/weights/4.p', 'optimizer': <function _load_optimizer.<locals>._wrapped at 0x7f2a7a363a60>, 'optimizer_path': '../data/models/config1/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/optimizer/4.p', 'loss': 0.26863087620586157, 'data_loss': -999, 'losses': {}, 'acc': 0.7578125, 'unsup_acc': 0.66015625, 'cached': True}[0m
[02;37m[2020-08-18 18:13:34,209][pipeline:jesus][INFO] [0m[32mvalid run at ../data/models/config1/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/covid_vaf2-rnd5-quest_bm25_k1-3.9_b-0.55.20_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/runs/24.run[0m
[02;37m[2020-08-18 18:13:34,209][pipeline:jesus][INFO] [0m[32mvalid epoch=4 map=0.0277 [mrr@10=0.8611] ndcg@10=0.4801 ndcg@20=0.4577 p@20=0.4944 runscore_alpha=0.2574[0m
