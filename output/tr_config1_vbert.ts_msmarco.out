Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex.
[02;37m[2020-08-20 09:54:49,278][onir.config][WARNING] [0m[33mArgument vocab.source=glove set but no matching setting in <class 'onir.vocab.bert_vocab.BertVocab'>[0m
[02;37m[2020-08-20 09:54:49,279][onir.config][WARNING] [0m[33mArgument vocab.variant=cc-42b-300d set but no matching setting in <class 'onir.vocab.bert_vocab.BertVocab'>[0m
[02;37m[2020-08-20 09:54:56,030][trainer:pairwise][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-20 09:54:56,032][onir.config][WARNING] [0m[33munknown bm25 arg k1-0.82[0m
[02;37m[2020-08-20 09:54:56,032][onir.config][WARNING] [0m[33munknown bm25 arg b-0.68[0m
[02;37m[2020-08-20 09:54:56,032][onir.config][WARNING] [0m[33mArgument test_ds.2020_filter=True set but no matching setting in <class 'onir.datasets.msmarco.MsmarcoDataset'>[0m
[02;37m[2020-08-20 09:54:56,032][onir.config][WARNING] [0m[33mArgument test_ds.rr_field=title_abs set but no matching setting in <class 'onir.datasets.msmarco.MsmarcoDataset'>[0m
[02;37m[2020-08-20 09:54:56,032][onir.config][WARNING] [0m[33mArgument test_ds.bs_field=text set but no matching setting in <class 'onir.datasets.msmarco.MsmarcoDataset'>[0m
[02;37m[2020-08-20 09:54:56,032][onir.config][WARNING] [0m[33mArgument test_ds.bs_override=rnd5-query set but no matching setting in <class 'onir.datasets.msmarco.MsmarcoDataset'>[0m
[02;37m[2020-08-20 09:54:56,036][onir.injector][DEBUG] [0m[37mConfiguration:[0m
 vocab       bert                                                            
-----------------------------------------------------------------------------
 bert_base   bert-base-uncased  |  bert_weights  [02;37m[empty][0m  |  layer     -1    
 last_layer  False              |  train         [33mTrue[0m     |  encoding  joint 

 train_ds  covid                                                                  
----------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mtrf2-rnd5-quest[0m  |  ranktopk  1000 
 date      2020-07-16          |  2020_filter  [33mTrue[0m             |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m       |  fold      all  

 ranker   vanilla_transformer                                          
-----------------------------------------------------------------------
 qlen     [33m40[0m                   |  dlen     2000  |  add_runscore  [33mTrue[0m 
 combine  linear               |  outputs  1                           

 trainer     pairwise                                                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 batch_size  16        |  batches_per_epoch  32         |  grad_acc_batch  [33m1[0m                                                                                                              
 optimizer   adam      |  lr                 0.001      |  gpu             True                                                                                                           
 gpu_determ  True      |  encoder_lr         [33m2e-05[0m      |  pipeline        [33mcovid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m 
 lossfn      softmax   |  pos_source         intersect  |  neg_source      run                                                                                                            
 sampling    query     |  pos_minrel         1          |  unjudged_rel    0                                                                                                              
 num_neg     1         |  margin             0.0                                                                                                                                          

 valid_ds  covid                                                                  
----------------------------------------------------------------------------------
 rankfn    [33mbm25_k1-3.9_b-0.55[0m  |  subset       [33mvaf2-rnd5-quest[0m  |  ranktopk  [33m20[0m   
 date      2020-07-16          |  2020_filter  [33mTrue[0m             |  bs_field  text 
 rr_field  title_abs           |  bs_override  [33mrnd5-query[0m       |  fold      all  

 valid_pred  reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  [33m4[0m         |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 test_ds              msmarco                                                                              
-----------------------------------------------------------------------------------------------------------
 rankfn               [33mbm25_k1-0.82_b-0.68[0m  |  subset           [33mjudgeddev[0m  |  ranktopk                 100  
 special              [02;37m[empty][0m              |  index            default    |  init_skip_train10        True 
 init_skip_train_med  True                 |  init_skip_msrun  True       |  init_skip_doctttttquery  True 

 test_pred   reranker                                                                                
-----------------------------------------------------------------------------------------------------
 batch_size  [33m4[0m         |  gpu            True  |  gpu_determ  True                                   
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map@1000,p@1,p@20,rprec[0m 
 source      run                                                                                     

 pipeline      jesus                                                                                                
--------------------------------------------------------------------------------------------------------------------
 max_epoch     1000    |  early_stop     20     |  warmup       -1                                                  
 val_metric    [33mmrr@10[0m  |  purge_weights  True   |  test         [33mTrue[0m                                                
 initial_eval  False   |  skip_ds_init   False  |  only_cached  False                                               
 onlytest      [33mTrue[0m    |  finetune       [33mTrue[0m   |  savefile     [33mmodel_vbert-train_msmarco-train_cord19-test_msmarco[0m 
[0m
[02;37m[2020-08-20 09:54:56,037][valid_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-20 09:54:56,038][trainer:pairwise][INFO] [0m[32mtrain path: ../data/models/config1/vanilla_transformer_40q_2000d_addrun/bert_bert-base-uncased_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m
[02;37m[2020-08-20 09:54:59,307][trainer:pairwise][INFO] [0m[32mloading prev model : ../data/models/config1/vanilla_transformer_40q_2000d_addrun/bert_bert-base-uncased_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m
[02;37m[2020-08-20 09:55:00,117][pipeline:jesus][DEBUG] [0m[37m[jesus] skipping training[0m
[02;37m[2020-08-20 09:55:00,118][pipeline:jesus][DEBUG] [0m[37m[jesus] loading top context[0m
[02;37m[2020-08-20 09:55:00,118][pipeline:jesus][DEBUG] [0m[37m[jesus] Top epoch context: {'epoch': -1, 'batch_size': 16, 'batches_per_epoch': 32, 'num_microbatches': 16, 'device': device(type='cuda'), 'base_path': '../data/models/config1/vanilla_transformer_40q_2000d_addrun/bert_bert-base-uncased_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs', 'ranker': <function Trainer.iter_train.<locals>.<lambda> at 0x7fdc7c65f0d0>, 'ranker_path': '../data/models/config1/vanilla_transformer_40q_2000d_addrun/bert_bert-base-uncased_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/weights/-2.p', 'optimizer': <function Trainer.iter_train.<locals>.<lambda> at 0x7fdc7c65f158>, 'optimizer_path': '../data/models/config1/vanilla_transformer_40q_2000d_addrun/bert_bert-base-uncased_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/optimizer/-2.p'}[0m
[02;37m[2020-08-20 09:55:00,118][pipeline:jesus][INFO] [0m[32mStarting load ranker[0m
[02;37m[2020-08-20 09:55:00,118][pipeline:jesus][INFO] [0m[32mStarting test predictor run[0m
[02;37m[2020-08-20 09:55:00,118][pipeline:jesus][DEBUG] [0m[37m[starting] testing[0m
[02;37m[2020-08-20 09:55:00,118][test_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-20 09:55:00,461][test_ds:msmarco][DEBUG] [0m[37m[starting] loading bm25_k1-0.82_b-0.68:100 from larger batch bm25_k1-0.82_b-0.68:1000[0m
[02;37m[2020-08-20 09:56:15,595][test_ds:msmarco][DEBUG] [0m[37m[finished] loading bm25_k1-0.82_b-0.68:100 from larger batch bm25_k1-0.82_b-0.68:1000 [01:15][0m
[02;37m[2020-08-20 09:56:15,606][test_ds:msmarco][DEBUG] [0m[37m[starting] loading bm25_k1-0.82_b-0.68:100 from larger batch bm25_k1-0.82_b-0.68:1000[0m
[02;37m[2020-08-20 09:57:42,185][test_ds:msmarco][DEBUG] [0m[37m[finished] loading bm25_k1-0.82_b-0.68:100 from larger batch bm25_k1-0.82_b-0.68:1000 [01:27][0m
[02;37m[2020-08-20 09:57:42,469][test_ds:msmarco][DEBUG] [0m[37m[starting] loading queries[0m
[02;37m[2020-08-20 09:57:42,545][test_ds:msmarco][DEBUG] [0m[37m[finished] loading queries: [76ms] [55578it] [735841.88it/s][0m
[02;37m[2020-08-20 09:57:42,546][onir.interfaces.java][DEBUG] [0m[37m[starting] initializing jnius[0m
[02;37m[2020-08-20 09:57:43,451][onir.interfaces.java][DEBUG] [0m[37m[finished] initializing jnius [906ms][0m
[02;37m[2020-08-20 21:11:52,704][test_ds:msmarco][DEBUG] [0m[37m[starting] loading qrels[0m
[02;37m[2020-08-20 21:11:52,792][test_ds:msmarco][DEBUG] [0m[37m[finished] loading qrels [89ms][0m
[02;37m[2020-08-20 21:12:08,692][pipeline:jesus][DEBUG] [0m[37m[finished] testing [11:17:09][0m
[02;37m[2020-08-20 21:12:08,693][pipeline:jesus][INFO] [0m[32mtest run at ../data/models/config1/vanilla_transformer_40q_2000d_addrun/bert_bert-base-uncased_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs/msmarco_judgeddev_bm25_k1-0.82_b-0.68.100/runs/-1.run[0m
[02;37m[2020-08-20 21:12:08,693][pipeline:jesus][INFO] [0m[32mtest  epoch=-1 map@1000=0.2633 [mrr@10=0.2591] ndcg@20=0.3339 p@1=0.1583 p@20=0.0301 rprec=0.1574 runscore_alpha=0.3373[0m
