Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex.
[02;37m[2020-08-22 06:09:08,764][onir.config][WARNING] [0m[33mArgument vocab.source=glove set but no matching setting in <class 'onir.vocab.bert_vocab.BertVocab'>[0m
[02;37m[2020-08-22 06:09:08,765][onir.config][WARNING] [0m[33mArgument vocab.variant=cc-42b-300d set but no matching setting in <class 'onir.vocab.bert_vocab.BertVocab'>[0m
[02;37m[2020-08-22 06:09:09,210][onir.config][WARNING] [0m[33munknown bm25 arg k1-0.82[0m
[02;37m[2020-08-22 06:09:09,210][onir.config][WARNING] [0m[33munknown bm25 arg b-0.68[0m
[02;37m[2020-08-22 06:09:14,887][vocab:bert][DEBUG] [0m[37m[starting] loading BERT weights from ../data/vocab/bert/config2[0m
[02;37m[2020-08-22 06:09:15,235][vocab:bert][DEBUG] [0m[37m[finished] loading BERT weights from ../data/vocab/bert/config2 [350ms][0m
[02;37m[2020-08-22 06:09:15,268][trainer:pairwise][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-22 06:09:15,268][onir.config][WARNING] [0m[33munknown bm25 arg k1-0.82[0m
[02;37m[2020-08-22 06:09:15,269][onir.config][WARNING] [0m[33munknown bm25 arg b-0.68[0m
[02;37m[2020-08-22 06:09:15,270][onir.config][WARNING] [0m[33munknown bm25 arg k1-0.82[0m
[02;37m[2020-08-22 06:09:15,270][onir.config][WARNING] [0m[33munknown bm25 arg b-0.68[0m
[02;37m[2020-08-22 06:09:15,274][onir.injector][DEBUG] [0m[37mConfiguration:[0m
 vocab       bert                                                            
-----------------------------------------------------------------------------
 bert_base   bert-base-uncased  |  bert_weights  [33mconfig2[0m  |  layer     -1    
 last_layer  False              |  train         [33mTrue[0m     |  encoding  joint 

 train_ds             msmarco                                                                            
---------------------------------------------------------------------------------------------------------
 rankfn               [33mbm25_k1-0.82_b-0.68[0m  |  subset           train    |  ranktopk                 100  
 special              [33mmspairs[0m              |  index            default  |  init_skip_train10        True 
 init_skip_train_med  True                 |  init_skip_msrun  True     |  init_skip_doctttttquery  True 

 ranker  cedr_knrm                                                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------
 qlen    [33m40[0m                                                |  dlen    2000                                           |  add_runscore  [33mTrue[0m 
 mus     -0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.0  |  sigmas  0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.001  |  grad_kernels  True 

 trainer     pairwise                                                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 batch_size  16        |  batches_per_epoch  32         |  grad_acc_batch  [33m1[0m                                                                                                              
 optimizer   adam      |  lr                 0.001      |  gpu             True                                                                                                           
 gpu_determ  True      |  encoder_lr         [33m2e-05[0m      |  pipeline        [33mcovid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m 
 lossfn      softmax   |  pos_source         intersect  |  neg_source      run                                                                                                            
 sampling    query     |  pos_minrel         1          |  unjudged_rel    0                                                                                                              
 num_neg     1         |  margin             0.0                                                                                                                                          

 valid_ds             msmarco                                                                            
---------------------------------------------------------------------------------------------------------
 rankfn               [33mbm25_k1-0.82_b-0.68[0m  |  subset           [33mminidev[0m  |  ranktopk                 [33m20[0m   
 special              [02;37m[empty][0m              |  index            default  |  init_skip_train10        True 
 init_skip_train_med  True                 |  init_skip_msrun  True     |  init_skip_doctttttquery  True 

 valid_pred  reranker                                                                                
-----------------------------------------------------------------------------------------------------
 batch_size  [33m4[0m         |  gpu            True  |  gpu_determ  True                                   
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map@1000,p@1,p@20,rprec[0m 
 source      run                                                                                     

 test_ds              msmarco                                                                              
-----------------------------------------------------------------------------------------------------------
 rankfn               [33mbm25_k1-0.82_b-0.68[0m  |  subset           [33mjudgeddev[0m  |  ranktopk                 100  
 special              [02;37m[empty][0m              |  index            default    |  init_skip_train10        True 
 init_skip_train_med  True                 |  init_skip_msrun  True       |  init_skip_doctttttquery  True 

 test_pred   reranker                                                                                
-----------------------------------------------------------------------------------------------------
 batch_size  [33m4[0m         |  gpu            True  |  gpu_determ  True                                   
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map@1000,p@1,p@20,rprec[0m 
 source      run                                                                                     

 pipeline      jesus                                                  
----------------------------------------------------------------------
 max_epoch     1000    |  early_stop     20     |  warmup       -1    
 val_metric    [33mmrr@10[0m  |  purge_weights  True   |  test         False 
 initial_eval  False   |  skip_ds_init   False  |  only_cached  False 
 onlytest      False   |  finetune       [33mTrue[0m   |  savefile     _     
[0m
[02;37m[2020-08-22 06:09:15,274][valid_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-22 06:09:15,275][trainer:pairwise][INFO] [0m[32mtrain path: ../data/models/config2/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config2_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m
[02;37m[2020-08-22 06:09:17,891][trainer:pairwise][INFO] [0m[32mloading prev model : ../data/models/config2/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config2_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m
[02;37m[2020-08-22 06:09:19,853][train_ds:msmarco][WARNING] [0m[33mUsing mspairs; ingoring pair_iter arguments pos_source=intersect neg_source=run sampling=query[0m
[02;37m[2020-08-22 06:09:19,865][train_ds:msmarco][DEBUG] [0m[37m[starting] loading queries[0m
[02;37m[2020-08-22 06:09:20,787][train_ds:msmarco][DEBUG] [0m[37m[finished] loading queries: [921ms] [808531it] [878120.46it/s][0m
[02;37m[2020-08-22 06:09:20,788][onir.interfaces.java][DEBUG] [0m[37m[starting] initializing jnius[0m
[02;37m[2020-08-22 06:09:21,563][onir.interfaces.java][DEBUG] [0m[37m[finished] initializing jnius [775ms][0m
[02;37m[2020-08-22 06:10:00,125][pipeline:jesus][DEBUG] [0m[37m[train] epoch=0 loss=0.0883 acc=0.9316 unsup_acc=0.7520 delta_acc=0.1797[0m
[02;37m[2020-08-22 06:10:00,131][valid_ds:msmarco][DEBUG] [0m[37m[starting] loading bm25_k1-0.82_b-0.68:20 from larger batch bm25_k1-0.82_b-0.68:1000[0m
[02;37m[2020-08-22 06:10:00,356][valid_ds:msmarco][DEBUG] [0m[37m[finished] loading bm25_k1-0.82_b-0.68:20 from larger batch bm25_k1-0.82_b-0.68:1000 [225ms][0m
[02;37m[2020-08-22 06:10:00,358][valid_ds:msmarco][DEBUG] [0m[37m[starting] loading bm25_k1-0.82_b-0.68:20 from larger batch bm25_k1-0.82_b-0.68:1000[0m
[02;37m[2020-08-22 06:10:00,661][valid_ds:msmarco][DEBUG] [0m[37m[finished] loading bm25_k1-0.82_b-0.68:20 from larger batch bm25_k1-0.82_b-0.68:1000 [303ms][0m
[02;37m[2020-08-22 06:10:00,667][valid_ds:msmarco][DEBUG] [0m[37m[starting] loading queries[0m
[02;37m[2020-08-22 06:10:00,668][valid_ds:msmarco][DEBUG] [0m[37m[finished] loading queries: [0ms] [200it] [627420.19it/s][0m
[02;37m[2020-08-22 06:10:30,740][valid_ds:msmarco][DEBUG] [0m[37m[starting] loading qrels[0m
[02;37m[2020-08-22 06:10:30,740][valid_ds:msmarco][DEBUG] [0m[37m[finished] loading qrels [1ms][0m
[02;37m[2020-08-22 06:10:30,761][pipeline:jesus][INFO] [0m[32m[valid] epoch=0 map@1000=0.2124 [mrr@10=0.2137] ndcg@20=0.2724 p@1=0.1210 p@20=0.0242 rprec=0.1210 runscore_alpha=0.2808 <---[0m
[02;37m[2020-08-22 06:11:09,557][pipeline:jesus][DEBUG] [0m[37m[train] epoch=1 loss=0.0518 acc=0.9609 unsup_acc=0.7461 delta_acc=0.2148[0m
[02;37m[2020-08-22 06:11:39,488][pipeline:jesus][INFO] [0m[32m[valid] epoch=1 map@1000=0.2209 [mrr@10=0.2229] ndcg@20=0.2790 p@1=0.1290 p@20=0.0242 rprec=0.1290 runscore_alpha=0.2834 <---[0m
[02;37m[2020-08-22 06:12:15,844][pipeline:jesus][DEBUG] [0m[37m[train] epoch=2 loss=0.0601 acc=0.9473 unsup_acc=0.7715 delta_acc=0.1758[0m
[02;37m[2020-08-22 06:12:45,699][pipeline:jesus][INFO] [0m[32m[valid] epoch=2 map@1000=0.2278 [mrr@10=0.2312] ndcg@20=0.2844 p@1=0.1371 p@20=0.0242 rprec=0.1371 runscore_alpha=0.2858 <---[0m
[02;37m[2020-08-22 06:13:22,536][pipeline:jesus][DEBUG] [0m[37m[train] epoch=3 loss=0.0565 acc=0.9512 unsup_acc=0.7285 delta_acc=0.2227[0m
[02;37m[2020-08-22 06:13:52,106][pipeline:jesus][INFO] [0m[32m[valid] epoch=3 map@1000=0.2179 [mrr@10=0.2202] ndcg@20=0.2766 p@1=0.1290 p@20=0.0242 rprec=0.1250 runscore_alpha=0.2882[0m
[02;37m[2020-08-22 06:14:27,569][pipeline:jesus][DEBUG] [0m[37m[train] epoch=4 loss=0.0481 acc=0.9570 unsup_acc=0.7578 delta_acc=0.1992[0m
[02;37m[2020-08-22 06:14:57,136][pipeline:jesus][INFO] [0m[32m[valid] epoch=4 map@1000=0.2174 [mrr@10=0.2189] ndcg@20=0.2761 p@1=0.1290 p@20=0.0242 rprec=0.1250 runscore_alpha=0.2908[0m
[02;37m[2020-08-22 06:15:34,591][pipeline:jesus][DEBUG] [0m[37m[train] epoch=5 loss=0.0329 acc=0.9746 unsup_acc=0.7637 delta_acc=0.2109[0m
[02;37m[2020-08-22 06:16:04,430][pipeline:jesus][INFO] [0m[32m[valid] epoch=5 map@1000=0.2168 [mrr@10=0.2179] ndcg@20=0.2760 p@1=0.1210 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2925[0m
[02;37m[2020-08-22 06:16:41,449][pipeline:jesus][DEBUG] [0m[37m[train] epoch=6 loss=0.0300 acc=0.9727 unsup_acc=0.7129 delta_acc=0.2598[0m
[02;37m[2020-08-22 06:17:10,697][pipeline:jesus][INFO] [0m[32m[valid] epoch=6 map@1000=0.2227 [mrr@10=0.2252] ndcg@20=0.2802 p@1=0.1371 p@20=0.0242 rprec=0.1331 runscore_alpha=0.2941[0m
[02;37m[2020-08-22 06:17:44,327][pipeline:jesus][DEBUG] [0m[37m[train] epoch=7 loss=0.0404 acc=0.9609 unsup_acc=0.7324 delta_acc=0.2285[0m
[02;37m[2020-08-22 06:18:13,973][pipeline:jesus][INFO] [0m[32m[valid] epoch=7 map@1000=0.2393 [mrr@10=0.2421] ndcg@20=0.2925 p@1=0.1694 p@20=0.0242 rprec=0.1653 runscore_alpha=0.2949 <---[0m
[02;37m[2020-08-22 06:18:50,972][pipeline:jesus][DEBUG] [0m[37m[train] epoch=8 loss=0.0603 acc=0.9414 unsup_acc=0.7363 delta_acc=0.2051[0m
[02;37m[2020-08-22 06:19:20,643][pipeline:jesus][INFO] [0m[32m[valid] epoch=8 map@1000=0.2326 [mrr@10=0.2336] ndcg@20=0.2879 p@1=0.1532 p@20=0.0242 rprec=0.1492 runscore_alpha=0.2950[0m
[02;37m[2020-08-22 06:19:57,309][pipeline:jesus][DEBUG] [0m[37m[train] epoch=9 loss=0.0576 acc=0.9473 unsup_acc=0.7480 delta_acc=0.1992[0m
[02;37m[2020-08-22 06:20:27,060][pipeline:jesus][INFO] [0m[32m[valid] epoch=9 map@1000=0.2375 [mrr@10=0.2396] ndcg@20=0.2916 p@1=0.1613 p@20=0.0242 rprec=0.1573 runscore_alpha=0.2958[0m
[02;37m[2020-08-22 06:21:03,636][pipeline:jesus][DEBUG] [0m[37m[train] epoch=10 loss=0.0302 acc=0.9746 unsup_acc=0.7441 delta_acc=0.2305[0m
[02;37m[2020-08-22 06:21:32,851][pipeline:jesus][INFO] [0m[32m[valid] epoch=10 map@1000=0.2343 [mrr@10=0.2365] ndcg@20=0.2894 p@1=0.1532 p@20=0.0242 rprec=0.1492 runscore_alpha=0.2969[0m
[02;37m[2020-08-22 06:22:06,385][pipeline:jesus][DEBUG] [0m[37m[train] epoch=11 loss=0.0360 acc=0.9629 unsup_acc=0.7832 delta_acc=0.1797[0m
[02;37m[2020-08-22 06:22:35,997][pipeline:jesus][INFO] [0m[32m[valid] epoch=11 map@1000=0.2420 [mrr@10=0.2434] ndcg@20=0.2947 p@1=0.1694 p@20=0.0242 rprec=0.1653 runscore_alpha=0.2977 <---[0m
[02;37m[2020-08-22 06:23:13,137][pipeline:jesus][DEBUG] [0m[37m[train] epoch=12 loss=0.0441 acc=0.9590 unsup_acc=0.7480 delta_acc=0.2109[0m
[02;37m[2020-08-22 06:23:42,838][pipeline:jesus][INFO] [0m[32m[valid] epoch=12 map@1000=0.2442 [mrr@10=0.2460] ndcg@20=0.2963 p@1=0.1694 p@20=0.0242 rprec=0.1653 runscore_alpha=0.2981 <---[0m
[02;37m[2020-08-22 06:24:18,792][pipeline:jesus][DEBUG] [0m[37m[train] epoch=13 loss=0.0450 acc=0.9551 unsup_acc=0.7695 delta_acc=0.1855[0m
[02;37m[2020-08-22 06:24:48,163][pipeline:jesus][INFO] [0m[32m[valid] epoch=13 map@1000=0.2392 [mrr@10=0.2423] ndcg@20=0.2932 p@1=0.1613 p@20=0.0242 rprec=0.1573 runscore_alpha=0.2985[0m
[02;37m[2020-08-22 06:25:25,978][pipeline:jesus][DEBUG] [0m[37m[train] epoch=14 loss=0.0310 acc=0.9746 unsup_acc=0.7441 delta_acc=0.2305[0m
[02;37m[2020-08-22 06:25:55,475][pipeline:jesus][INFO] [0m[32m[valid] epoch=14 map@1000=0.2379 [mrr@10=0.2421] ndcg@20=0.2924 p@1=0.1532 p@20=0.0242 rprec=0.1492 runscore_alpha=0.2999[0m
[02;37m[2020-08-22 06:26:32,721][pipeline:jesus][DEBUG] [0m[37m[train] epoch=15 loss=0.0379 acc=0.9590 unsup_acc=0.7832 delta_acc=0.1758[0m
[02;37m[2020-08-22 06:27:02,270][pipeline:jesus][INFO] [0m[32m[valid] epoch=15 map@1000=0.2339 [mrr@10=0.2388] ndcg@20=0.2896 p@1=0.1452 p@20=0.0242 rprec=0.1452 runscore_alpha=0.3002[0m
[02;37m[2020-08-22 06:27:39,517][pipeline:jesus][DEBUG] [0m[37m[train] epoch=16 loss=0.0375 acc=0.9668 unsup_acc=0.7715 delta_acc=0.1953[0m
[02;37m[2020-08-22 06:28:08,797][pipeline:jesus][INFO] [0m[32m[valid] epoch=16 map@1000=0.2316 [mrr@10=0.2355] ndcg@20=0.2875 p@1=0.1532 p@20=0.0242 rprec=0.1532 runscore_alpha=0.3006[0m
[02;37m[2020-08-22 06:28:45,246][pipeline:jesus][DEBUG] [0m[37m[train] epoch=17 loss=0.0344 acc=0.9688 unsup_acc=0.7363 delta_acc=0.2324[0m
[02;37m[2020-08-22 06:29:14,681][pipeline:jesus][INFO] [0m[32m[valid] epoch=17 map@1000=0.2380 [mrr@10=0.2428] ndcg@20=0.2928 p@1=0.1532 p@20=0.0242 rprec=0.1532 runscore_alpha=0.2994[0m
[02;37m[2020-08-22 06:29:51,994][pipeline:jesus][DEBUG] [0m[37m[train] epoch=18 loss=0.0335 acc=0.9727 unsup_acc=0.7598 delta_acc=0.2129[0m
[02;37m[2020-08-22 06:30:21,611][pipeline:jesus][INFO] [0m[32m[valid] epoch=18 map@1000=0.2234 [mrr@10=0.2268] ndcg@20=0.2811 p@1=0.1371 p@20=0.0242 rprec=0.1331 runscore_alpha=0.3007[0m
[02;37m[2020-08-22 06:30:59,296][pipeline:jesus][DEBUG] [0m[37m[train] epoch=19 loss=0.0456 acc=0.9531 unsup_acc=0.7910 delta_acc=0.1621[0m
[02;37m[2020-08-22 06:31:28,793][pipeline:jesus][INFO] [0m[32m[valid] epoch=19 map@1000=0.2337 [mrr@10=0.2351] ndcg@20=0.2887 p@1=0.1532 p@20=0.0242 rprec=0.1492 runscore_alpha=0.3007[0m
[02;37m[2020-08-22 06:32:05,147][pipeline:jesus][DEBUG] [0m[37m[train] epoch=20 loss=0.0475 acc=0.9512 unsup_acc=0.6992 delta_acc=0.2520[0m
[02;37m[2020-08-22 06:32:35,023][pipeline:jesus][INFO] [0m[32m[valid] epoch=20 map@1000=0.2343 [mrr@10=0.2394] ndcg@20=0.2904 p@1=0.1371 p@20=0.0242 rprec=0.1371 runscore_alpha=0.2997[0m
[02;37m[2020-08-22 06:33:08,446][pipeline:jesus][DEBUG] [0m[37m[train] epoch=21 loss=0.0502 acc=0.9512 unsup_acc=0.7422 delta_acc=0.2090[0m
[02;37m[2020-08-22 06:33:38,029][pipeline:jesus][INFO] [0m[32m[valid] epoch=21 map@1000=0.2452 [mrr@10=0.2492] ndcg@20=0.2983 p@1=0.1613 p@20=0.0242 rprec=0.1573 runscore_alpha=0.3000 <---[0m
[02;37m[2020-08-22 06:34:15,081][pipeline:jesus][DEBUG] [0m[37m[train] epoch=22 loss=0.0428 acc=0.9629 unsup_acc=0.7754 delta_acc=0.1875[0m
[02;37m[2020-08-22 06:34:44,793][pipeline:jesus][INFO] [0m[32m[valid] epoch=22 map@1000=0.2409 [mrr@10=0.2464] ndcg@20=0.2958 p@1=0.1452 p@20=0.0242 rprec=0.1492 runscore_alpha=0.3000[0m
[02;37m[2020-08-22 06:35:22,601][pipeline:jesus][DEBUG] [0m[37m[train] epoch=23 loss=0.0515 acc=0.9492 unsup_acc=0.7773 delta_acc=0.1719[0m
[02;37m[2020-08-22 06:35:52,060][pipeline:jesus][INFO] [0m[32m[valid] epoch=23 map@1000=0.2291 [mrr@10=0.2342] ndcg@20=0.2864 p@1=0.1371 p@20=0.0242 rprec=0.1371 runscore_alpha=0.3009[0m
[02;37m[2020-08-22 06:36:24,951][pipeline:jesus][DEBUG] [0m[37m[train] epoch=24 loss=0.0256 acc=0.9805 unsup_acc=0.7773 delta_acc=0.2031[0m
[02;37m[2020-08-22 06:36:54,751][pipeline:jesus][INFO] [0m[32m[valid] epoch=24 map@1000=0.2407 [mrr@10=0.2455] ndcg@20=0.2953 p@1=0.1452 p@20=0.0242 rprec=0.1452 runscore_alpha=0.3030[0m
[02;37m[2020-08-22 06:37:32,206][pipeline:jesus][DEBUG] [0m[37m[train] epoch=25 loss=0.0323 acc=0.9707 unsup_acc=0.7617 delta_acc=0.2090[0m
[02;37m[2020-08-22 06:38:01,898][pipeline:jesus][INFO] [0m[32m[valid] epoch=25 map@1000=0.2446 [mrr@10=0.2491] ndcg@20=0.2981 p@1=0.1532 p@20=0.0242 rprec=0.1492 runscore_alpha=0.3040[0m
[02;37m[2020-08-22 06:38:39,408][pipeline:jesus][DEBUG] [0m[37m[train] epoch=26 loss=0.0349 acc=0.9668 unsup_acc=0.7598 delta_acc=0.2070[0m
[02;37m[2020-08-22 06:39:09,303][pipeline:jesus][INFO] [0m[32m[valid] epoch=26 map@1000=0.2299 [mrr@10=0.2354] ndcg@20=0.2871 p@1=0.1371 p@20=0.0242 rprec=0.1331 runscore_alpha=0.3041[0m
[02;37m[2020-08-22 06:39:45,156][pipeline:jesus][DEBUG] [0m[37m[train] epoch=27 loss=0.0416 acc=0.9590 unsup_acc=0.7715 delta_acc=0.1875[0m
[02;37m[2020-08-22 06:40:14,819][pipeline:jesus][INFO] [0m[32m[valid] epoch=27 map@1000=0.2197 [mrr@10=0.2256] ndcg@20=0.2794 p@1=0.1210 p@20=0.0242 rprec=0.1210 runscore_alpha=0.3038[0m
[02;37m[2020-08-22 06:40:52,855][pipeline:jesus][DEBUG] [0m[37m[train] epoch=28 loss=0.0503 acc=0.9512 unsup_acc=0.7207 delta_acc=0.2305[0m
[02;37m[2020-08-22 06:41:22,623][pipeline:jesus][INFO] [0m[32m[valid] epoch=28 map@1000=0.2323 [mrr@10=0.2385] ndcg@20=0.2893 p@1=0.1371 p@20=0.0242 rprec=0.1371 runscore_alpha=0.3049[0m
[02;37m[2020-08-22 06:42:00,075][pipeline:jesus][DEBUG] [0m[37m[train] epoch=29 loss=0.0403 acc=0.9609 unsup_acc=0.7773 delta_acc=0.1836[0m
[02;37m[2020-08-22 06:42:29,260][pipeline:jesus][INFO] [0m[32m[valid] epoch=29 map@1000=0.2403 [mrr@10=0.2443] ndcg@20=0.2952 p@1=0.1452 p@20=0.0242 rprec=0.1411 runscore_alpha=0.3057[0m
[02;37m[2020-08-22 06:43:06,896][pipeline:jesus][DEBUG] [0m[37m[train] epoch=30 loss=0.0264 acc=0.9727 unsup_acc=0.7520 delta_acc=0.2207[0m
[02;37m[2020-08-22 06:43:36,767][pipeline:jesus][INFO] [0m[32m[valid] epoch=30 map@1000=0.2467 [mrr@10=0.2515] ndcg@20=0.2999 p@1=0.1613 p@20=0.0242 rprec=0.1573 runscore_alpha=0.3068 <---[0m
[02;37m[2020-08-22 06:44:13,970][pipeline:jesus][DEBUG] [0m[37m[train] epoch=31 loss=0.0365 acc=0.9648 unsup_acc=0.7656 delta_acc=0.1992[0m
[02;37m[2020-08-22 06:44:43,580][pipeline:jesus][INFO] [0m[32m[valid] epoch=31 map@1000=0.2449 [mrr@10=0.2503] ndcg@20=0.2988 p@1=0.1532 p@20=0.0242 rprec=0.1573 runscore_alpha=0.3070[0m
[02;37m[2020-08-22 06:45:19,452][pipeline:jesus][DEBUG] [0m[37m[train] epoch=32 loss=0.0306 acc=0.9727 unsup_acc=0.7715 delta_acc=0.2012[0m
[02;37m[2020-08-22 06:45:49,229][pipeline:jesus][INFO] [0m[32m[valid] epoch=32 map@1000=0.2434 [mrr@10=0.2483] ndcg@20=0.2973 p@1=0.1532 p@20=0.0242 rprec=0.1532 runscore_alpha=0.3071[0m
[02;37m[2020-08-22 06:46:25,704][pipeline:jesus][DEBUG] [0m[37m[train] epoch=33 loss=0.0278 acc=0.9746 unsup_acc=0.7617 delta_acc=0.2129[0m
[02;37m[2020-08-22 06:46:55,372][pipeline:jesus][INFO] [0m[32m[valid] epoch=33 map@1000=0.2436 [mrr@10=0.2478] ndcg@20=0.2975 p@1=0.1532 p@20=0.0242 rprec=0.1532 runscore_alpha=0.3079[0m
[02;37m[2020-08-22 06:47:31,777][pipeline:jesus][DEBUG] [0m[37m[train] epoch=34 loss=0.0434 acc=0.9590 unsup_acc=0.7617 delta_acc=0.1973[0m
[02;37m[2020-08-22 06:48:01,720][pipeline:jesus][INFO] [0m[32m[valid] epoch=34 map@1000=0.2525 [mrr@10=0.2582] ndcg@20=0.3046 p@1=0.1694 p@20=0.0242 rprec=0.1613 runscore_alpha=0.3091 <---[0m
[02;37m[2020-08-22 06:48:37,853][pipeline:jesus][DEBUG] [0m[37m[train] epoch=35 loss=0.0479 acc=0.9551 unsup_acc=0.7676 delta_acc=0.1875[0m
[02;37m[2020-08-22 06:49:07,279][pipeline:jesus][INFO] [0m[32m[valid] epoch=35 map@1000=0.2551 [mrr@10=0.2608] ndcg@20=0.3063 p@1=0.1774 p@20=0.0242 rprec=0.1694 runscore_alpha=0.3106 <---[0m
[02;37m[2020-08-22 06:49:42,341][pipeline:jesus][DEBUG] [0m[37m[train] epoch=36 loss=0.0458 acc=0.9551 unsup_acc=0.7754 delta_acc=0.1797[0m
[02;37m[2020-08-22 06:50:11,998][pipeline:jesus][INFO] [0m[32m[valid] epoch=36 map@1000=0.2438 [mrr@10=0.2504] ndcg@20=0.2980 p@1=0.1532 p@20=0.0242 rprec=0.1452 runscore_alpha=0.3104[0m
[02;37m[2020-08-22 06:50:49,563][pipeline:jesus][DEBUG] [0m[37m[train] epoch=37 loss=0.0366 acc=0.9688 unsup_acc=0.7812 delta_acc=0.1875[0m
[02;37m[2020-08-22 06:51:19,095][pipeline:jesus][INFO] [0m[32m[valid] epoch=37 map@1000=0.2460 [mrr@10=0.2563] ndcg@20=0.3008 p@1=0.1532 p@20=0.0242 rprec=0.1411 runscore_alpha=0.3102[0m
[02;37m[2020-08-22 06:51:56,628][pipeline:jesus][DEBUG] [0m[37m[train] epoch=38 loss=0.0448 acc=0.9570 unsup_acc=0.7305 delta_acc=0.2266[0m
[02;37m[2020-08-22 06:52:26,282][pipeline:jesus][INFO] [0m[32m[valid] epoch=38 map@1000=0.2457 [mrr@10=0.2548] ndcg@20=0.2998 p@1=0.1694 p@20=0.0242 rprec=0.1653 runscore_alpha=0.3112[0m
[02;37m[2020-08-22 06:53:03,501][pipeline:jesus][DEBUG] [0m[37m[train] epoch=39 loss=0.0364 acc=0.9609 unsup_acc=0.6973 delta_acc=0.2637[0m
[02;37m[2020-08-22 06:53:33,383][pipeline:jesus][INFO] [0m[32m[valid] epoch=39 map@1000=0.2559 [mrr@10=0.2641] ndcg@20=0.3077 p@1=0.1774 p@20=0.0242 rprec=0.1734 runscore_alpha=0.3108 <---[0m
[02;37m[2020-08-22 06:54:10,482][pipeline:jesus][DEBUG] [0m[37m[train] epoch=40 loss=0.0458 acc=0.9531 unsup_acc=0.6875 delta_acc=0.2656[0m
[02;37m[2020-08-22 06:54:40,246][pipeline:jesus][INFO] [0m[32m[valid] epoch=40 map@1000=0.2608 [mrr@10=0.2716] ndcg@20=0.3122 p@1=0.1855 p@20=0.0242 rprec=0.1774 runscore_alpha=0.3103 <---[0m
[02;37m[2020-08-22 06:55:15,688][pipeline:jesus][DEBUG] [0m[37m[train] epoch=41 loss=0.0451 acc=0.9570 unsup_acc=0.7012 delta_acc=0.2559[0m
[02;37m[2020-08-22 06:55:45,036][pipeline:jesus][INFO] [0m[32m[valid] epoch=41 map@1000=0.2510 [mrr@10=0.2614] ndcg@20=0.3053 p@1=0.1613 p@20=0.0242 rprec=0.1492 runscore_alpha=0.3117[0m
[02;37m[2020-08-22 06:56:21,720][pipeline:jesus][DEBUG] [0m[37m[train] epoch=42 loss=0.0256 acc=0.9746 unsup_acc=0.6406 delta_acc=0.3340[0m
[02;37m[2020-08-22 06:56:51,381][pipeline:jesus][INFO] [0m[32m[valid] epoch=42 map@1000=0.2438 [mrr@10=0.2532] ndcg@20=0.2996 p@1=0.1532 p@20=0.0242 rprec=0.1411 runscore_alpha=0.3124[0m
[02;37m[2020-08-22 06:57:28,588][pipeline:jesus][DEBUG] [0m[37m[train] epoch=43 loss=0.0451 acc=0.9590 unsup_acc=0.7266 delta_acc=0.2324[0m
[02;37m[2020-08-22 06:57:57,875][pipeline:jesus][INFO] [0m[32m[valid] epoch=43 map@1000=0.2603 [mrr@10=0.2682] ndcg@20=0.3110 p@1=0.1855 p@20=0.0242 rprec=0.1774 runscore_alpha=0.3146[0m
[02;37m[2020-08-22 06:58:33,873][pipeline:jesus][DEBUG] [0m[37m[train] epoch=44 loss=0.0189 acc=0.9844 unsup_acc=0.7305 delta_acc=0.2539[0m
[02;37m[2020-08-22 06:59:04,222][pipeline:jesus][INFO] [0m[32m[valid] epoch=44 map@1000=0.2671 [mrr@10=0.2756] ndcg@20=0.3166 p@1=0.1935 p@20=0.0242 rprec=0.1815 runscore_alpha=0.3164 <---[0m
[02;37m[2020-08-22 06:59:41,379][pipeline:jesus][DEBUG] [0m[37m[train] epoch=45 loss=0.0340 acc=0.9707 unsup_acc=0.7539 delta_acc=0.2168[0m
[02;37m[2020-08-22 07:00:11,108][pipeline:jesus][INFO] [0m[32m[valid] epoch=45 map@1000=0.2471 [mrr@10=0.2541] ndcg@20=0.3012 p@1=0.1613 p@20=0.0242 rprec=0.1532 runscore_alpha=0.3175[0m
[02;37m[2020-08-22 07:00:45,383][pipeline:jesus][DEBUG] [0m[37m[train] epoch=46 loss=0.0562 acc=0.9414 unsup_acc=0.7637 delta_acc=0.1777[0m
[02;37m[2020-08-22 07:01:14,885][pipeline:jesus][INFO] [0m[32m[valid] epoch=46 map@1000=0.2412 [mrr@10=0.2478] ndcg@20=0.2964 p@1=0.1532 p@20=0.0242 rprec=0.1452 runscore_alpha=0.3169[0m
[02;37m[2020-08-22 07:01:49,261][pipeline:jesus][DEBUG] [0m[37m[train] epoch=47 loss=0.0540 acc=0.9414 unsup_acc=0.7754 delta_acc=0.1660[0m
[02;37m[2020-08-22 07:02:19,166][pipeline:jesus][INFO] [0m[32m[valid] epoch=47 map@1000=0.2375 [mrr@10=0.2453] ndcg@20=0.2944 p@1=0.1371 p@20=0.0242 rprec=0.1290 runscore_alpha=0.3175[0m
[02;37m[2020-08-22 07:02:58,149][pipeline:jesus][DEBUG] [0m[37m[train] epoch=48 loss=0.0218 acc=0.9785 unsup_acc=0.7480 delta_acc=0.2305[0m
[02;37m[2020-08-22 07:03:27,852][pipeline:jesus][INFO] [0m[32m[valid] epoch=48 map@1000=0.2451 [mrr@10=0.2531] ndcg@20=0.3004 p@1=0.1371 p@20=0.0242 rprec=0.1290 runscore_alpha=0.3179[0m
[02;37m[2020-08-22 07:04:06,435][pipeline:jesus][DEBUG] [0m[37m[train] epoch=49 loss=0.0387 acc=0.9590 unsup_acc=0.7598 delta_acc=0.1992[0m
[02;37m[2020-08-22 07:04:36,013][pipeline:jesus][INFO] [0m[32m[valid] epoch=49 map@1000=0.2375 [mrr@10=0.2427] ndcg@20=0.2935 p@1=0.1371 p@20=0.0242 rprec=0.1371 runscore_alpha=0.3174[0m
[02;37m[2020-08-22 07:05:11,019][pipeline:jesus][DEBUG] [0m[37m[train] epoch=50 loss=0.0281 acc=0.9727 unsup_acc=0.7871 delta_acc=0.1855[0m
[02;37m[2020-08-22 07:05:40,622][pipeline:jesus][INFO] [0m[32m[valid] epoch=50 map@1000=0.2463 [mrr@10=0.2516] ndcg@20=0.3004 p@1=0.1452 p@20=0.0242 rprec=0.1452 runscore_alpha=0.3180[0m
[02;37m[2020-08-22 07:06:16,663][pipeline:jesus][DEBUG] [0m[37m[train] epoch=51 loss=0.0263 acc=0.9766 unsup_acc=0.7930 delta_acc=0.1836[0m
[02;37m[2020-08-22 07:06:46,232][pipeline:jesus][INFO] [0m[32m[valid] epoch=51 map@1000=0.2425 [mrr@10=0.2504] ndcg@20=0.2980 p@1=0.1371 p@20=0.0242 rprec=0.1290 runscore_alpha=0.3185[0m
[02;37m[2020-08-22 07:07:23,699][pipeline:jesus][DEBUG] [0m[37m[train] epoch=52 loss=0.0270 acc=0.9727 unsup_acc=0.7715 delta_acc=0.2012[0m
[02;37m[2020-08-22 07:07:53,375][pipeline:jesus][INFO] [0m[32m[valid] epoch=52 map@1000=0.2364 [mrr@10=0.2416] ndcg@20=0.2927 p@1=0.1371 p@20=0.0242 rprec=0.1371 runscore_alpha=0.3185[0m
[02;37m[2020-08-22 07:08:29,620][pipeline:jesus][DEBUG] [0m[37m[train] epoch=53 loss=0.0354 acc=0.9688 unsup_acc=0.7754 delta_acc=0.1934[0m
[02;37m[2020-08-22 07:08:56,334][pipeline:jesus][INFO] [0m[32m[valid] epoch=53 map@1000=0.2383 [mrr@10=0.2433] ndcg@20=0.2944 p@1=0.1290 p@20=0.0242 rprec=0.1290 runscore_alpha=0.3186[0m
[02;37m[2020-08-22 07:09:30,906][pipeline:jesus][DEBUG] [0m[37m[train] epoch=54 loss=0.0253 acc=0.9785 unsup_acc=0.6699 delta_acc=0.3086[0m
[02;37m[2020-08-22 07:10:00,589][pipeline:jesus][INFO] [0m[32m[valid] epoch=54 map@1000=0.2541 [mrr@10=0.2604] ndcg@20=0.3068 p@1=0.1452 p@20=0.0242 rprec=0.1492 runscore_alpha=0.3218[0m
[02;37m[2020-08-22 07:10:37,999][pipeline:jesus][DEBUG] [0m[37m[train] epoch=55 loss=0.0268 acc=0.9746 unsup_acc=0.6816 delta_acc=0.2930[0m
[02;37m[2020-08-22 07:11:07,494][pipeline:jesus][INFO] [0m[32m[valid] epoch=55 map@1000=0.2543 [mrr@10=0.2606] ndcg@20=0.3067 p@1=0.1532 p@20=0.0242 rprec=0.1573 runscore_alpha=0.3225[0m
[02;37m[2020-08-22 07:11:42,919][pipeline:jesus][DEBUG] [0m[37m[train] epoch=56 loss=0.0315 acc=0.9688 unsup_acc=0.7832 delta_acc=0.1855[0m
[02;37m[2020-08-22 07:12:08,236][pipeline:jesus][INFO] [0m[32m[valid] epoch=56 map@1000=0.2423 [mrr@10=0.2529] ndcg@20=0.2989 p@1=0.1371 p@20=0.0242 rprec=0.1290 runscore_alpha=0.3224[0m
[02;37m[2020-08-22 07:12:44,099][pipeline:jesus][DEBUG] [0m[37m[train] epoch=57 loss=0.0398 acc=0.9609 unsup_acc=0.7559 delta_acc=0.2051[0m
[02;37m[2020-08-22 07:13:12,448][pipeline:jesus][INFO] [0m[32m[valid] epoch=57 map@1000=0.2522 [mrr@10=0.2618] ndcg@20=0.3062 p@1=0.1452 p@20=0.0242 rprec=0.1371 runscore_alpha=0.3240[0m
[02;37m[2020-08-22 07:13:49,110][pipeline:jesus][DEBUG] [0m[37m[train] epoch=58 loss=0.0333 acc=0.9668 unsup_acc=0.7812 delta_acc=0.1855[0m
[02;37m[2020-08-22 07:14:18,695][pipeline:jesus][INFO] [0m[32m[valid] epoch=58 map@1000=0.2515 [mrr@10=0.2610] ndcg@20=0.3050 p@1=0.1613 p@20=0.0242 rprec=0.1532 runscore_alpha=0.3233[0m
[02;37m[2020-08-22 07:14:55,512][pipeline:jesus][DEBUG] [0m[37m[train] epoch=59 loss=0.0280 acc=0.9746 unsup_acc=0.7109 delta_acc=0.2637[0m
[02;37m[2020-08-22 07:15:24,406][pipeline:jesus][INFO] [0m[32m[valid] epoch=59 map@1000=0.2468 [mrr@10=0.2557] ndcg@20=0.3017 p@1=0.1452 p@20=0.0242 rprec=0.1411 runscore_alpha=0.3240[0m
[02;37m[2020-08-22 07:16:02,042][pipeline:jesus][DEBUG] [0m[37m[train] epoch=60 loss=0.0337 acc=0.9648 unsup_acc=0.7559 delta_acc=0.2090[0m
[02;37m[2020-08-22 07:16:31,660][pipeline:jesus][INFO] [0m[32m[valid] epoch=60 map@1000=0.2418 [mrr@10=0.2477] ndcg@20=0.2970 p@1=0.1452 p@20=0.0242 rprec=0.1452 runscore_alpha=0.3243[0m
[02;37m[2020-08-22 07:17:10,143][pipeline:jesus][DEBUG] [0m[37m[train] epoch=61 loss=0.0263 acc=0.9746 unsup_acc=0.7539 delta_acc=0.2207[0m
[02;37m[2020-08-22 07:17:40,124][pipeline:jesus][INFO] [0m[32m[valid] epoch=61 map@1000=0.2409 [mrr@10=0.2468] ndcg@20=0.2965 p@1=0.1371 p@20=0.0242 rprec=0.1371 runscore_alpha=0.3249[0m
[02;37m[2020-08-22 07:18:17,809][pipeline:jesus][DEBUG] [0m[37m[train] epoch=62 loss=0.0459 acc=0.9551 unsup_acc=0.7891 delta_acc=0.1660[0m
[02;37m[2020-08-22 07:18:47,519][pipeline:jesus][INFO] [0m[32m[valid] epoch=62 map@1000=0.2283 [mrr@10=0.2310] ndcg@20=0.2856 p@1=0.1290 p@20=0.0242 rprec=0.1331 runscore_alpha=0.3260[0m
[02;37m[2020-08-22 07:19:25,071][pipeline:jesus][DEBUG] [0m[37m[train] epoch=63 loss=0.0450 acc=0.9609 unsup_acc=0.7891 delta_acc=0.1719[0m
[02;37m[2020-08-22 07:19:54,613][pipeline:jesus][INFO] [0m[32m[valid] epoch=63 map@1000=0.2179 [mrr@10=0.2241] ndcg@20=0.2786 p@1=0.1129 p@20=0.0242 rprec=0.1129 runscore_alpha=0.3264[0m
[02;37m[2020-08-22 07:20:29,820][pipeline:jesus][DEBUG] [0m[37m[train] epoch=64 loss=0.0364 acc=0.9648 unsup_acc=0.7422 delta_acc=0.2227[0m
[02;37m[2020-08-22 07:20:59,575][pipeline:jesus][INFO] [0m[32m[valid] epoch=64 map@1000=0.2248 [mrr@10=0.2337] ndcg@20=0.2849 p@1=0.1129 p@20=0.0242 rprec=0.1129 runscore_alpha=0.3276[0m
[02;37m[2020-08-22 07:20:59,575][pipeline:jesus][WARNING] [0m[33mstopping after epoch 64 (20 epochs with no improvement to mrr@10)[0m
[02;37m[2020-08-22 07:20:59,576][pipeline:jesus][INFO] [0m[32mtop validation epoch=44 mrr@10=0.2755696364567332[0m
[02;37m[2020-08-22 07:20:59,576][pipeline:jesus][INFO] [0m[32m[jesus: top_train_ctxt] {'epoch': 44, 'batch_size': 16, 'batches_per_epoch': 32, 'num_microbatches': 16, 'device': device(type='cuda'), 'base_path': '../data/models/config2/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config2_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs', 'ranker': <function Trainer.iter_train.<locals>.<lambda> at 0x7f320e064400>, 'ranker_path': '../data/models/config2/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config2_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs/weights/44.p', 'optimizer': <function Trainer.iter_train.<locals>.<lambda> at 0x7f311c2de7b8>, 'optimizer_path': '../data/models/config2/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config2_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs/optimizer/44.p', 'loss': 0.018912716303020716, 'losses': {'data': 0.018912716303020716}, 'acc': 0.984375, 'unsup_acc': 0.73046875, 'cached': False}[0m
[02;37m[2020-08-22 07:21:02,785][pipeline:jesus][INFO] [0m[32mvalid run at ../data/models/config2/cedr_knrm_40q_2000d_addrun/bert_bert-base-uncased_config2_tr/pairwise_32x16x1_adam-0.001_encoderlr-2e-05_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs/msmarco_minidev_bm25_k1-0.82_b-0.68.20/runs/64.run[0m
[02;37m[2020-08-22 07:21:02,786][pipeline:jesus][INFO] [0m[32mvalid epoch=44 map@1000=0.2671 [mrr@10=0.2756] ndcg@20=0.3166 p@1=0.1935 p@20=0.0242 rprec=0.1815 runscore_alpha=0.3164[0m
