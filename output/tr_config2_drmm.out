Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex.
[02;37m[2020-08-19 12:29:39,518][vocab:wordvec_hash][DEBUG] [0m[37m[starting] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p[0m
[02;37m[2020-08-19 12:29:49,524][vocab:wordvec_hash][DEBUG] [0m[37m[finished] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p [10.01s][0m
[02;37m[2020-08-19 12:29:52,134][onir.config][WARNING] [0m[33munknown bm25 arg k1-0.82[0m
[02;37m[2020-08-19 12:29:52,134][onir.config][WARNING] [0m[33munknown bm25 arg b-0.68[0m
[02;37m[2020-08-19 12:30:00,999][trainer:pairwise][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-19 12:30:01,000][onir.config][WARNING] [0m[33munknown bm25 arg k1-0.82[0m
[02;37m[2020-08-19 12:30:01,000][onir.config][WARNING] [0m[33munknown bm25 arg b-0.68[0m
[02;37m[2020-08-19 12:30:01,001][onir.config][WARNING] [0m[33munknown bm25 arg k1-0.82[0m
[02;37m[2020-08-19 12:30:01,001][onir.config][WARNING] [0m[33munknown bm25 arg b-0.68[0m
[02;37m[2020-08-19 12:30:01,005][onir.injector][DEBUG] [0m[37mConfiguration:[0m
 vocab      wordvec_hash                                                  
--------------------------------------------------------------------------
 source     [33mglove[0m         |  variant      [33mcc-42b-300d[0m  |  train     False 
 hashspace  1000          |  init_stddev  0.5          |  log_miss  False 

 train_ds             msmarco                                                                            
---------------------------------------------------------------------------------------------------------
 rankfn               [33mbm25_k1-0.82_b-0.68[0m  |  subset           train    |  ranktopk                 100  
 special              [33mmspairs[0m              |  index            default  |  init_skip_train10        True 
 init_skip_train_med  True                 |  init_skip_msrun  True     |  init_skip_doctttttquery  True 

 ranker   drmm                                            
----------------------------------------------------------
 qlen     [33m40[0m    |  dlen   2000  |  add_runscore  [33mTrue[0m     
 hidden   5     |  nbins  11    |  histo         logcount 
 combine  idf                                             

 trainer     pairwise                                                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 batch_size  16        |  batches_per_epoch  32         |  grad_acc_batch  0                                                                                                              
 optimizer   adam      |  lr                 0.001      |  gpu             True                                                                                                           
 gpu_determ  True      |  encoder_lr         0.0        |  pipeline        [33mcovid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m 
 lossfn      softmax   |  pos_source         intersect  |  neg_source      run                                                                                                            
 sampling    query     |  pos_minrel         1          |  unjudged_rel    0                                                                                                              
 num_neg     1         |  margin             0.0                                                                                                                                          

 valid_ds             msmarco                                                                            
---------------------------------------------------------------------------------------------------------
 rankfn               [33mbm25_k1-0.82_b-0.68[0m  |  subset           [33mminidev[0m  |  ranktopk                 [33m20[0m   
 special              [02;37m[empty][0m              |  index            default  |  init_skip_train10        True 
 init_skip_train_med  True                 |  init_skip_msrun  True     |  init_skip_doctttttquery  True 

 valid_pred  reranker                                                                                
-----------------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                                   
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map@1000,p@1,p@20,rprec[0m 
 source      run                                                                                     

 test_ds              msmarco                                                                              
-----------------------------------------------------------------------------------------------------------
 rankfn               [33mbm25_k1-0.82_b-0.68[0m  |  subset           [33mjudgeddev[0m  |  ranktopk                 100  
 special              [02;37m[empty][0m              |  index            default    |  init_skip_train10        True 
 init_skip_train_med  True                 |  init_skip_msrun  True       |  init_skip_doctttttquery  True 

 test_pred   reranker                                                                                
-----------------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                                   
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map@1000,p@1,p@20,rprec[0m 
 source      run                                                                                     

 pipeline      jesus                                                  
----------------------------------------------------------------------
 max_epoch     1000    |  early_stop     20     |  warmup       -1    
 val_metric    [33mmrr@10[0m  |  purge_weights  True   |  test         False 
 initial_eval  False   |  skip_ds_init   False  |  only_cached  False 
 onlytest      False   |  finetune       [33mTrue[0m   |  savefile     _     
[0m
[02;37m[2020-08-19 12:30:01,005][valid_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-19 12:30:01,007][trainer:pairwise][INFO] [0m[32mtrain path: ../data/models/config2/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m
[02;37m[2020-08-19 12:30:04,202][trainer:pairwise][INFO] [0m[32mloading prev model : ../data/models/config2/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/covid_trf2-rnd5-quest_bm25_k1-3.9_b-0.55.1000_2020-07-16_bs-text_2020filter_bsoverride-rnd5-query_rr-title_abs[0m
[02;37m[2020-08-19 12:30:04,207][train_ds:msmarco][WARNING] [0m[33mUsing mspairs; ingoring pair_iter arguments pos_source=intersect neg_source=run sampling=query[0m
[02;37m[2020-08-19 12:30:04,209][train_ds:msmarco][DEBUG] [0m[37m[starting] loading queries[0m
[02;37m[2020-08-19 12:30:05,285][train_ds:msmarco][DEBUG] [0m[37m[finished] loading queries: [1.07s] [808531it] [752436.39it/s][0m
[02;37m[2020-08-19 12:30:05,286][onir.interfaces.java][DEBUG] [0m[37m[starting] initializing jnius[0m
[02;37m[2020-08-19 12:30:06,150][onir.interfaces.java][DEBUG] [0m[37m[finished] initializing jnius [864ms][0m
[02;37m[2020-08-19 12:30:09,188][pipeline:jesus][DEBUG] [0m[37m[train] epoch=0 loss=0.1470 acc=0.8965 unsup_acc=0.9121 delta_acc=-0.0156[0m
[02;37m[2020-08-19 12:30:09,191][valid_ds:msmarco][DEBUG] [0m[37m[starting] loading bm25_k1-0.82_b-0.68:20 from larger batch bm25_k1-0.82_b-0.68:1000[0m
[02;37m[2020-08-19 12:30:09,457][valid_ds:msmarco][DEBUG] [0m[37m[finished] loading bm25_k1-0.82_b-0.68:20 from larger batch bm25_k1-0.82_b-0.68:1000 [267ms][0m
[02;37m[2020-08-19 12:30:09,461][valid_ds:msmarco][DEBUG] [0m[37m[starting] loading bm25_k1-0.82_b-0.68:20 from larger batch bm25_k1-0.82_b-0.68:1000[0m
[02;37m[2020-08-19 12:30:09,790][valid_ds:msmarco][DEBUG] [0m[37m[finished] loading bm25_k1-0.82_b-0.68:20 from larger batch bm25_k1-0.82_b-0.68:1000 [329ms][0m
[02;37m[2020-08-19 12:30:09,792][valid_ds:msmarco][DEBUG] [0m[37m[starting] loading queries[0m
[02;37m[2020-08-19 12:30:09,794][valid_ds:msmarco][DEBUG] [0m[37m[finished] loading queries: [1ms] [200it] [261816.73it/s][0m
[02;37m[2020-08-19 12:30:18,829][valid_ds:msmarco][DEBUG] [0m[37m[starting] loading qrels[0m
[02;37m[2020-08-19 12:30:18,830][valid_ds:msmarco][DEBUG] [0m[37m[finished] loading qrels [1ms][0m
[02;37m[2020-08-19 12:30:18,849][pipeline:jesus][INFO] [0m[32m[valid] epoch=0 map@1000=0.1715 [mrr@10=0.1688] ndcg@20=0.2394 p@1=0.0806 p@20=0.0242 rprec=0.0806 runscore_alpha=0.3077 <---[0m
[02;37m[2020-08-19 12:30:20,987][pipeline:jesus][DEBUG] [0m[37m[train] epoch=1 loss=0.1201 acc=0.9141 unsup_acc=0.9277 delta_acc=-0.0137[0m
[02;37m[2020-08-19 12:30:25,066][pipeline:jesus][INFO] [0m[32m[valid] epoch=1 map@1000=0.1690 [mrr@10=0.1668] ndcg@20=0.2377 p@1=0.0726 p@20=0.0242 rprec=0.0726 runscore_alpha=0.3013[0m
[02;37m[2020-08-19 12:30:27,539][pipeline:jesus][DEBUG] [0m[37m[train] epoch=2 loss=0.1326 acc=0.8926 unsup_acc=0.9219 delta_acc=-0.0293[0m
[02;37m[2020-08-19 12:30:31,860][pipeline:jesus][INFO] [0m[32m[valid] epoch=2 map@1000=0.1684 [mrr@10=0.1664] ndcg@20=0.2373 p@1=0.0726 p@20=0.0242 rprec=0.0726 runscore_alpha=0.2961[0m
[02;37m[2020-08-19 12:30:34,178][pipeline:jesus][DEBUG] [0m[37m[train] epoch=3 loss=0.1467 acc=0.8906 unsup_acc=0.9180 delta_acc=-0.0273[0m
[02;37m[2020-08-19 12:30:38,640][pipeline:jesus][INFO] [0m[32m[valid] epoch=3 map@1000=0.1721 [mrr@10=0.1702] ndcg@20=0.2404 p@1=0.0726 p@20=0.0242 rprec=0.0726 runscore_alpha=0.2901 <---[0m
[02;37m[2020-08-19 12:30:40,937][pipeline:jesus][DEBUG] [0m[37m[train] epoch=4 loss=0.1302 acc=0.9043 unsup_acc=0.9121 delta_acc=-0.0078[0m
[02;37m[2020-08-19 12:30:45,200][pipeline:jesus][INFO] [0m[32m[valid] epoch=4 map@1000=0.1785 [mrr@10=0.1763] ndcg@20=0.2453 p@1=0.0806 p@20=0.0242 rprec=0.0806 runscore_alpha=0.2845 <---[0m
[02;37m[2020-08-19 12:30:47,521][pipeline:jesus][DEBUG] [0m[37m[train] epoch=5 loss=0.1298 acc=0.9160 unsup_acc=0.9316 delta_acc=-0.0156[0m
[02;37m[2020-08-19 12:30:52,142][pipeline:jesus][INFO] [0m[32m[valid] epoch=5 map@1000=0.1822 [mrr@10=0.1798] ndcg@20=0.2484 p@1=0.0806 p@20=0.0242 rprec=0.0806 runscore_alpha=0.2792 <---[0m
[02;37m[2020-08-19 12:30:54,325][pipeline:jesus][DEBUG] [0m[37m[train] epoch=6 loss=0.1067 acc=0.9238 unsup_acc=0.9336 delta_acc=-0.0098[0m
[02;37m[2020-08-19 12:30:58,560][pipeline:jesus][INFO] [0m[32m[valid] epoch=6 map@1000=0.1796 [mrr@10=0.1771] ndcg@20=0.2464 p@1=0.0806 p@20=0.0242 rprec=0.0806 runscore_alpha=0.2759[0m
[02;37m[2020-08-19 12:31:00,853][pipeline:jesus][DEBUG] [0m[37m[train] epoch=7 loss=0.1260 acc=0.9102 unsup_acc=0.9199 delta_acc=-0.0098[0m
[02;37m[2020-08-19 12:31:04,934][pipeline:jesus][INFO] [0m[32m[valid] epoch=7 map@1000=0.1799 [mrr@10=0.1782] ndcg@20=0.2466 p@1=0.0806 p@20=0.0242 rprec=0.0806 runscore_alpha=0.2728[0m
[02;37m[2020-08-19 12:31:07,086][pipeline:jesus][DEBUG] [0m[37m[train] epoch=8 loss=0.1390 acc=0.8965 unsup_acc=0.8965 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:31:11,346][pipeline:jesus][INFO] [0m[32m[valid] epoch=8 map@1000=0.1802 [mrr@10=0.1786] ndcg@20=0.2469 p@1=0.0806 p@20=0.0242 rprec=0.0806 runscore_alpha=0.2692[0m
[02;37m[2020-08-19 12:31:13,606][pipeline:jesus][DEBUG] [0m[37m[train] epoch=9 loss=0.1603 acc=0.8867 unsup_acc=0.8965 delta_acc=-0.0098[0m
[02;37m[2020-08-19 12:31:18,004][pipeline:jesus][INFO] [0m[32m[valid] epoch=9 map@1000=0.1832 [mrr@10=0.1816] ndcg@20=0.2493 p@1=0.0806 p@20=0.0242 rprec=0.0806 runscore_alpha=0.2652 <---[0m
[02;37m[2020-08-19 12:31:20,340][pipeline:jesus][DEBUG] [0m[37m[train] epoch=10 loss=0.1203 acc=0.9082 unsup_acc=0.9277 delta_acc=-0.0195[0m
[02;37m[2020-08-19 12:31:24,483][pipeline:jesus][INFO] [0m[32m[valid] epoch=10 map@1000=0.1848 [mrr@10=0.1833] ndcg@20=0.2506 p@1=0.0806 p@20=0.0242 rprec=0.0806 runscore_alpha=0.2610 <---[0m
[02;37m[2020-08-19 12:31:26,733][pipeline:jesus][DEBUG] [0m[37m[train] epoch=11 loss=0.1325 acc=0.9062 unsup_acc=0.9219 delta_acc=-0.0156[0m
[02;37m[2020-08-19 12:31:31,262][pipeline:jesus][INFO] [0m[32m[valid] epoch=11 map@1000=0.1898 [mrr@10=0.1882] ndcg@20=0.2544 p@1=0.0887 p@20=0.0242 rprec=0.0887 runscore_alpha=0.2564 <---[0m
[02;37m[2020-08-19 12:31:33,408][pipeline:jesus][DEBUG] [0m[37m[train] epoch=12 loss=0.1149 acc=0.9258 unsup_acc=0.9219 delta_acc=0.0039[0m
[02;37m[2020-08-19 12:31:37,572][pipeline:jesus][INFO] [0m[32m[valid] epoch=12 map@1000=0.1916 [mrr@10=0.1900] ndcg@20=0.2559 p@1=0.0887 p@20=0.0242 rprec=0.0887 runscore_alpha=0.2535 <---[0m
[02;37m[2020-08-19 12:31:39,784][pipeline:jesus][DEBUG] [0m[37m[train] epoch=13 loss=0.1264 acc=0.9199 unsup_acc=0.9199 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:31:44,192][pipeline:jesus][INFO] [0m[32m[valid] epoch=13 map@1000=0.1926 [mrr@10=0.1909] ndcg@20=0.2568 p@1=0.0887 p@20=0.0242 rprec=0.0887 runscore_alpha=0.2506 <---[0m
[02;37m[2020-08-19 12:31:46,619][pipeline:jesus][DEBUG] [0m[37m[train] epoch=14 loss=0.1114 acc=0.9258 unsup_acc=0.9277 delta_acc=-0.0020[0m
[02;37m[2020-08-19 12:31:50,952][pipeline:jesus][INFO] [0m[32m[valid] epoch=14 map@1000=0.1928 [mrr@10=0.1920] ndcg@20=0.2570 p@1=0.0887 p@20=0.0242 rprec=0.0887 runscore_alpha=0.2479 <---[0m
[02;37m[2020-08-19 12:31:53,175][pipeline:jesus][DEBUG] [0m[37m[train] epoch=15 loss=0.1155 acc=0.9414 unsup_acc=0.9395 delta_acc=0.0020[0m
[02;37m[2020-08-19 12:31:57,189][pipeline:jesus][INFO] [0m[32m[valid] epoch=15 map@1000=0.1934 [mrr@10=0.1925] ndcg@20=0.2575 p@1=0.0887 p@20=0.0242 rprec=0.0887 runscore_alpha=0.2446 <---[0m
[02;37m[2020-08-19 12:31:59,351][pipeline:jesus][DEBUG] [0m[37m[train] epoch=16 loss=0.1137 acc=0.9414 unsup_acc=0.9395 delta_acc=0.0020[0m
[02;37m[2020-08-19 12:32:03,711][pipeline:jesus][INFO] [0m[32m[valid] epoch=16 map@1000=0.1976 [mrr@10=0.1968] ndcg@20=0.2606 p@1=0.0968 p@20=0.0242 rprec=0.0968 runscore_alpha=0.2417 <---[0m
[02;37m[2020-08-19 12:32:05,913][pipeline:jesus][DEBUG] [0m[37m[train] epoch=17 loss=0.1129 acc=0.9219 unsup_acc=0.9277 delta_acc=-0.0059[0m
[02;37m[2020-08-19 12:32:10,202][pipeline:jesus][INFO] [0m[32m[valid] epoch=17 map@1000=0.1975 [mrr@10=0.1967] ndcg@20=0.2605 p@1=0.0968 p@20=0.0242 rprec=0.0968 runscore_alpha=0.2388[0m
[02;37m[2020-08-19 12:32:12,527][pipeline:jesus][DEBUG] [0m[37m[train] epoch=18 loss=0.1144 acc=0.9297 unsup_acc=0.9395 delta_acc=-0.0098[0m
[02;37m[2020-08-19 12:32:16,662][pipeline:jesus][INFO] [0m[32m[valid] epoch=18 map@1000=0.2016 [mrr@10=0.2007] ndcg@20=0.2636 p@1=0.1048 p@20=0.0242 rprec=0.1048 runscore_alpha=0.2370 <---[0m
[02;37m[2020-08-19 12:32:18,824][pipeline:jesus][DEBUG] [0m[37m[train] epoch=19 loss=0.1225 acc=0.9141 unsup_acc=0.9277 delta_acc=-0.0137[0m
[02;37m[2020-08-19 12:32:22,942][pipeline:jesus][INFO] [0m[32m[valid] epoch=19 map@1000=0.1977 [mrr@10=0.1968] ndcg@20=0.2607 p@1=0.0968 p@20=0.0242 rprec=0.0968 runscore_alpha=0.2339[0m
[02;37m[2020-08-19 12:32:25,248][pipeline:jesus][DEBUG] [0m[37m[train] epoch=20 loss=0.1272 acc=0.9238 unsup_acc=0.9141 delta_acc=0.0098[0m
[02;37m[2020-08-19 12:32:29,506][pipeline:jesus][INFO] [0m[32m[valid] epoch=20 map@1000=0.2035 [mrr@10=0.2026] ndcg@20=0.2651 p@1=0.1048 p@20=0.0242 rprec=0.1048 runscore_alpha=0.2317 <---[0m
[02;37m[2020-08-19 12:32:31,709][pipeline:jesus][DEBUG] [0m[37m[train] epoch=21 loss=0.1210 acc=0.9277 unsup_acc=0.9258 delta_acc=0.0020[0m
[02;37m[2020-08-19 12:32:36,045][pipeline:jesus][INFO] [0m[32m[valid] epoch=21 map@1000=0.2021 [mrr@10=0.2012] ndcg@20=0.2640 p@1=0.1048 p@20=0.0242 rprec=0.1048 runscore_alpha=0.2298[0m
[02;37m[2020-08-19 12:32:38,305][pipeline:jesus][DEBUG] [0m[37m[train] epoch=22 loss=0.1313 acc=0.9102 unsup_acc=0.9238 delta_acc=-0.0137[0m
[02;37m[2020-08-19 12:32:42,732][pipeline:jesus][INFO] [0m[32m[valid] epoch=22 map@1000=0.2033 [mrr@10=0.2025] ndcg@20=0.2650 p@1=0.1048 p@20=0.0242 rprec=0.1048 runscore_alpha=0.2267[0m
[02;37m[2020-08-19 12:32:45,064][pipeline:jesus][DEBUG] [0m[37m[train] epoch=23 loss=0.1377 acc=0.8945 unsup_acc=0.8965 delta_acc=-0.0020[0m
[02;37m[2020-08-19 12:32:49,307][pipeline:jesus][INFO] [0m[32m[valid] epoch=23 map@1000=0.2073 [mrr@10=0.2064] ndcg@20=0.2678 p@1=0.1129 p@20=0.0242 rprec=0.1129 runscore_alpha=0.2247 <---[0m
[02;37m[2020-08-19 12:32:51,483][pipeline:jesus][DEBUG] [0m[37m[train] epoch=24 loss=0.1128 acc=0.9238 unsup_acc=0.9414 delta_acc=-0.0176[0m
[02;37m[2020-08-19 12:32:55,721][pipeline:jesus][INFO] [0m[32m[valid] epoch=24 map@1000=0.2023 [mrr@10=0.2011] ndcg@20=0.2640 p@1=0.1048 p@20=0.0242 rprec=0.1048 runscore_alpha=0.2225[0m
[02;37m[2020-08-19 12:32:57,787][pipeline:jesus][DEBUG] [0m[37m[train] epoch=25 loss=0.1273 acc=0.9121 unsup_acc=0.9102 delta_acc=0.0020[0m
[02;37m[2020-08-19 12:33:02,147][pipeline:jesus][INFO] [0m[32m[valid] epoch=25 map@1000=0.2075 [mrr@10=0.2065] ndcg@20=0.2680 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2207 <---[0m
[02;37m[2020-08-19 12:33:04,351][pipeline:jesus][DEBUG] [0m[37m[train] epoch=26 loss=0.1172 acc=0.9121 unsup_acc=0.9238 delta_acc=-0.0117[0m
[02;37m[2020-08-19 12:33:08,562][pipeline:jesus][INFO] [0m[32m[valid] epoch=26 map@1000=0.2075 [mrr@10=0.2073] ndcg@20=0.2681 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2188 <---[0m
[02;37m[2020-08-19 12:33:10,786][pipeline:jesus][DEBUG] [0m[37m[train] epoch=27 loss=0.1153 acc=0.9238 unsup_acc=0.9277 delta_acc=-0.0039[0m
[02;37m[2020-08-19 12:33:15,047][pipeline:jesus][INFO] [0m[32m[valid] epoch=27 map@1000=0.2077 [mrr@10=0.2075] ndcg@20=0.2683 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2161 <---[0m
[02;37m[2020-08-19 12:33:17,369][pipeline:jesus][DEBUG] [0m[37m[train] epoch=28 loss=0.1579 acc=0.8809 unsup_acc=0.8867 delta_acc=-0.0059[0m
[02;37m[2020-08-19 12:33:21,934][pipeline:jesus][INFO] [0m[32m[valid] epoch=28 map@1000=0.2077 [mrr@10=0.2075] ndcg@20=0.2683 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2136[0m
[02;37m[2020-08-19 12:33:24,131][pipeline:jesus][DEBUG] [0m[37m[train] epoch=29 loss=0.1182 acc=0.9258 unsup_acc=0.9160 delta_acc=0.0098[0m
[02;37m[2020-08-19 12:33:28,393][pipeline:jesus][INFO] [0m[32m[valid] epoch=29 map@1000=0.2069 [mrr@10=0.2068] ndcg@20=0.2676 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2119[0m
[02;37m[2020-08-19 12:33:30,136][pipeline:jesus][DEBUG] [0m[37m[train] epoch=30 loss=0.1138 acc=0.9238 unsup_acc=0.9316 delta_acc=-0.0078[0m
[02;37m[2020-08-19 12:33:34,304][pipeline:jesus][INFO] [0m[32m[valid] epoch=30 map@1000=0.2072 [mrr@10=0.2071] ndcg@20=0.2678 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2097[0m
[02;37m[2020-08-19 12:33:36,326][pipeline:jesus][DEBUG] [0m[37m[train] epoch=31 loss=0.1214 acc=0.9082 unsup_acc=0.9180 delta_acc=-0.0098[0m
[02;37m[2020-08-19 12:33:40,565][pipeline:jesus][INFO] [0m[32m[valid] epoch=31 map@1000=0.2079 [mrr@10=0.2077] ndcg@20=0.2683 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2071 <---[0m
[02;37m[2020-08-19 12:33:42,735][pipeline:jesus][DEBUG] [0m[37m[train] epoch=32 loss=0.1163 acc=0.9277 unsup_acc=0.9316 delta_acc=-0.0039[0m
[02;37m[2020-08-19 12:33:46,935][pipeline:jesus][INFO] [0m[32m[valid] epoch=32 map@1000=0.2080 [mrr@10=0.2079] ndcg@20=0.2685 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2039 <---[0m
[02;37m[2020-08-19 12:33:49,118][pipeline:jesus][DEBUG] [0m[37m[train] epoch=33 loss=0.1111 acc=0.9277 unsup_acc=0.9238 delta_acc=0.0039[0m
[02;37m[2020-08-19 12:33:53,370][pipeline:jesus][INFO] [0m[32m[valid] epoch=33 map@1000=0.2079 [mrr@10=0.2071] ndcg@20=0.2684 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2017[0m
[02;37m[2020-08-19 12:33:55,489][pipeline:jesus][DEBUG] [0m[37m[train] epoch=34 loss=0.1349 acc=0.9004 unsup_acc=0.9004 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:33:59,961][pipeline:jesus][INFO] [0m[32m[valid] epoch=34 map@1000=0.2095 [mrr@10=0.2100] ndcg@20=0.2696 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.2000 <---[0m
[02;37m[2020-08-19 12:34:02,067][pipeline:jesus][DEBUG] [0m[37m[train] epoch=35 loss=0.1148 acc=0.9277 unsup_acc=0.9277 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:34:06,288][pipeline:jesus][INFO] [0m[32m[valid] epoch=35 map@1000=0.2080 [mrr@10=0.2079] ndcg@20=0.2684 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1990[0m
[02;37m[2020-08-19 12:34:08,517][pipeline:jesus][DEBUG] [0m[37m[train] epoch=36 loss=0.1242 acc=0.9199 unsup_acc=0.9277 delta_acc=-0.0078[0m
[02;37m[2020-08-19 12:34:12,693][pipeline:jesus][INFO] [0m[32m[valid] epoch=36 map@1000=0.2095 [mrr@10=0.2101] ndcg@20=0.2697 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1971 <---[0m
[02;37m[2020-08-19 12:34:14,571][pipeline:jesus][DEBUG] [0m[37m[train] epoch=37 loss=0.1236 acc=0.9121 unsup_acc=0.9238 delta_acc=-0.0117[0m
[02;37m[2020-08-19 12:34:19,136][pipeline:jesus][INFO] [0m[32m[valid] epoch=37 map@1000=0.2094 [mrr@10=0.2100] ndcg@20=0.2696 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1953[0m
[02;37m[2020-08-19 12:34:21,415][pipeline:jesus][DEBUG] [0m[37m[train] epoch=38 loss=0.1289 acc=0.9082 unsup_acc=0.9043 delta_acc=0.0039[0m
[02;37m[2020-08-19 12:34:25,674][pipeline:jesus][INFO] [0m[32m[valid] epoch=38 map@1000=0.2095 [mrr@10=0.2101] ndcg@20=0.2697 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1934[0m
[02;37m[2020-08-19 12:34:27,778][pipeline:jesus][DEBUG] [0m[37m[train] epoch=39 loss=0.1076 acc=0.9238 unsup_acc=0.9199 delta_acc=0.0039[0m
[02;37m[2020-08-19 12:34:31,793][pipeline:jesus][INFO] [0m[32m[valid] epoch=39 map@1000=0.2082 [mrr@10=0.2088] ndcg@20=0.2686 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1922[0m
[02;37m[2020-08-19 12:34:33,950][pipeline:jesus][DEBUG] [0m[37m[train] epoch=40 loss=0.1117 acc=0.9336 unsup_acc=0.9316 delta_acc=0.0020[0m
[02;37m[2020-08-19 12:34:38,136][pipeline:jesus][INFO] [0m[32m[valid] epoch=40 map@1000=0.2082 [mrr@10=0.2088] ndcg@20=0.2686 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1901[0m
[02;37m[2020-08-19 12:34:40,323][pipeline:jesus][DEBUG] [0m[37m[train] epoch=41 loss=0.1183 acc=0.9121 unsup_acc=0.9102 delta_acc=0.0020[0m
[02;37m[2020-08-19 12:34:44,650][pipeline:jesus][INFO] [0m[32m[valid] epoch=41 map@1000=0.2102 [mrr@10=0.2108] ndcg@20=0.2702 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1887 <---[0m
[02;37m[2020-08-19 12:34:46,852][pipeline:jesus][DEBUG] [0m[37m[train] epoch=42 loss=0.0952 acc=0.9277 unsup_acc=0.9277 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:34:51,032][pipeline:jesus][INFO] [0m[32m[valid] epoch=42 map@1000=0.2062 [mrr@10=0.2068] ndcg@20=0.2672 p@1=0.1048 p@20=0.0242 rprec=0.1089 runscore_alpha=0.1875[0m
[02;37m[2020-08-19 12:34:53,125][pipeline:jesus][DEBUG] [0m[37m[train] epoch=43 loss=0.1256 acc=0.9102 unsup_acc=0.9043 delta_acc=0.0059[0m
[02;37m[2020-08-19 12:34:57,443][pipeline:jesus][INFO] [0m[32m[valid] epoch=43 map@1000=0.2060 [mrr@10=0.2066] ndcg@20=0.2671 p@1=0.1048 p@20=0.0242 rprec=0.1089 runscore_alpha=0.1865[0m
[02;37m[2020-08-19 12:34:59,472][pipeline:jesus][DEBUG] [0m[37m[train] epoch=44 loss=0.1356 acc=0.8945 unsup_acc=0.8945 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:35:03,649][pipeline:jesus][INFO] [0m[32m[valid] epoch=44 map@1000=0.2102 [mrr@10=0.2108] ndcg@20=0.2702 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1850[0m
[02;37m[2020-08-19 12:35:05,851][pipeline:jesus][DEBUG] [0m[37m[train] epoch=45 loss=0.1414 acc=0.8887 unsup_acc=0.8945 delta_acc=-0.0059[0m
[02;37m[2020-08-19 12:35:10,119][pipeline:jesus][INFO] [0m[32m[valid] epoch=45 map@1000=0.2101 [mrr@10=0.2107] ndcg@20=0.2702 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1840[0m
[02;37m[2020-08-19 12:35:12,478][pipeline:jesus][DEBUG] [0m[37m[train] epoch=46 loss=0.1337 acc=0.9180 unsup_acc=0.9082 delta_acc=0.0098[0m
[02;37m[2020-08-19 12:35:16,526][pipeline:jesus][INFO] [0m[32m[valid] epoch=46 map@1000=0.2062 [mrr@10=0.2061] ndcg@20=0.2673 p@1=0.1048 p@20=0.0242 rprec=0.1089 runscore_alpha=0.1822[0m
[02;37m[2020-08-19 12:35:18,660][pipeline:jesus][DEBUG] [0m[37m[train] epoch=47 loss=0.1356 acc=0.9121 unsup_acc=0.9160 delta_acc=-0.0039[0m
[02;37m[2020-08-19 12:35:22,925][pipeline:jesus][INFO] [0m[32m[valid] epoch=47 map@1000=0.2075 [mrr@10=0.2075] ndcg@20=0.2682 p@1=0.1048 p@20=0.0242 rprec=0.1089 runscore_alpha=0.1800[0m
[02;37m[2020-08-19 12:35:24,848][pipeline:jesus][DEBUG] [0m[37m[train] epoch=48 loss=0.1093 acc=0.9375 unsup_acc=0.9258 delta_acc=0.0117[0m
[02;37m[2020-08-19 12:35:29,056][pipeline:jesus][INFO] [0m[32m[valid] epoch=48 map@1000=0.2075 [mrr@10=0.2075] ndcg@20=0.2683 p@1=0.1048 p@20=0.0242 rprec=0.1089 runscore_alpha=0.1781[0m
[02;37m[2020-08-19 12:35:31,274][pipeline:jesus][DEBUG] [0m[37m[train] epoch=49 loss=0.1188 acc=0.9258 unsup_acc=0.9258 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:35:35,390][pipeline:jesus][INFO] [0m[32m[valid] epoch=49 map@1000=0.2074 [mrr@10=0.2074] ndcg@20=0.2682 p@1=0.1048 p@20=0.0242 rprec=0.1089 runscore_alpha=0.1769[0m
[02;37m[2020-08-19 12:35:37,601][pipeline:jesus][DEBUG] [0m[37m[train] epoch=50 loss=0.1026 acc=0.9355 unsup_acc=0.9316 delta_acc=0.0039[0m
[02;37m[2020-08-19 12:35:41,572][pipeline:jesus][INFO] [0m[32m[valid] epoch=50 map@1000=0.2065 [mrr@10=0.2072] ndcg@20=0.2676 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1769[0m
[02;37m[2020-08-19 12:35:43,754][pipeline:jesus][DEBUG] [0m[37m[train] epoch=51 loss=0.1040 acc=0.9277 unsup_acc=0.9336 delta_acc=-0.0059[0m
[02;37m[2020-08-19 12:35:47,328][pipeline:jesus][INFO] [0m[32m[valid] epoch=51 map@1000=0.2081 [mrr@10=0.2087] ndcg@20=0.2689 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1751[0m
[02;37m[2020-08-19 12:35:49,518][pipeline:jesus][DEBUG] [0m[37m[train] epoch=52 loss=0.1048 acc=0.9395 unsup_acc=0.9238 delta_acc=0.0156[0m
[02;37m[2020-08-19 12:35:53,800][pipeline:jesus][INFO] [0m[32m[valid] epoch=52 map@1000=0.2067 [mrr@10=0.2074] ndcg@20=0.2678 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1743[0m
[02;37m[2020-08-19 12:35:55,720][pipeline:jesus][DEBUG] [0m[37m[train] epoch=53 loss=0.1241 acc=0.9180 unsup_acc=0.9180 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:35:59,615][pipeline:jesus][INFO] [0m[32m[valid] epoch=53 map@1000=0.2075 [mrr@10=0.2081] ndcg@20=0.2684 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1734[0m
[02;37m[2020-08-19 12:36:01,718][pipeline:jesus][DEBUG] [0m[37m[train] epoch=54 loss=0.1167 acc=0.9141 unsup_acc=0.9062 delta_acc=0.0078[0m
[02;37m[2020-08-19 12:36:05,913][pipeline:jesus][INFO] [0m[32m[valid] epoch=54 map@1000=0.2073 [mrr@10=0.2079] ndcg@20=0.2683 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1732[0m
[02;37m[2020-08-19 12:36:07,963][pipeline:jesus][DEBUG] [0m[37m[train] epoch=55 loss=0.1061 acc=0.9297 unsup_acc=0.9277 delta_acc=0.0020[0m
[02;37m[2020-08-19 12:36:11,985][pipeline:jesus][INFO] [0m[32m[valid] epoch=55 map@1000=0.2060 [mrr@10=0.2065] ndcg@20=0.2673 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1719[0m
[02;37m[2020-08-19 12:36:14,323][pipeline:jesus][DEBUG] [0m[37m[train] epoch=56 loss=0.1097 acc=0.9199 unsup_acc=0.9277 delta_acc=-0.0078[0m
[02;37m[2020-08-19 12:36:18,948][pipeline:jesus][INFO] [0m[32m[valid] epoch=56 map@1000=0.2055 [mrr@10=0.2061] ndcg@20=0.2669 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1705[0m
[02;37m[2020-08-19 12:36:21,024][pipeline:jesus][DEBUG] [0m[37m[train] epoch=57 loss=0.1324 acc=0.9023 unsup_acc=0.9023 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:36:25,397][pipeline:jesus][INFO] [0m[32m[valid] epoch=57 map@1000=0.2061 [mrr@10=0.2067] ndcg@20=0.2673 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1692[0m
[02;37m[2020-08-19 12:36:27,574][pipeline:jesus][DEBUG] [0m[37m[train] epoch=58 loss=0.1242 acc=0.9199 unsup_acc=0.9199 delta_acc=0.0000[0m
[02;37m[2020-08-19 12:36:31,996][pipeline:jesus][INFO] [0m[32m[valid] epoch=58 map@1000=0.2061 [mrr@10=0.2067] ndcg@20=0.2673 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1674[0m
[02;37m[2020-08-19 12:36:34,036][pipeline:jesus][DEBUG] [0m[37m[train] epoch=59 loss=0.1076 acc=0.9238 unsup_acc=0.9336 delta_acc=-0.0098[0m
[02;37m[2020-08-19 12:36:38,271][pipeline:jesus][INFO] [0m[32m[valid] epoch=59 map@1000=0.2070 [mrr@10=0.2077] ndcg@20=0.2680 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1656[0m
[02;37m[2020-08-19 12:36:40,037][pipeline:jesus][DEBUG] [0m[37m[train] epoch=60 loss=0.1189 acc=0.9277 unsup_acc=0.9141 delta_acc=0.0137[0m
[02;37m[2020-08-19 12:36:44,386][pipeline:jesus][INFO] [0m[32m[valid] epoch=60 map@1000=0.2070 [mrr@10=0.2077] ndcg@20=0.2680 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1638[0m
[02;37m[2020-08-19 12:36:46,585][pipeline:jesus][DEBUG] [0m[37m[train] epoch=61 loss=0.1191 acc=0.9160 unsup_acc=0.9258 delta_acc=-0.0098[0m
[02;37m[2020-08-19 12:36:50,875][pipeline:jesus][INFO] [0m[32m[valid] epoch=61 map@1000=0.2068 [mrr@10=0.2074] ndcg@20=0.2678 p@1=0.1048 p@20=0.0242 rprec=0.1129 runscore_alpha=0.1627[0m
[02;37m[2020-08-19 12:36:50,875][pipeline:jesus][WARNING] [0m[33mstopping after epoch 61 (20 epochs with no improvement to mrr@10)[0m
[02;37m[2020-08-19 12:36:50,876][pipeline:jesus][INFO] [0m[32mtop validation epoch=41 mrr@10=0.2107910906298003[0m
[02;37m[2020-08-19 12:36:50,876][pipeline:jesus][INFO] [0m[32m[jesus: top_train_ctxt] {'epoch': 41, 'batch_size': 16, 'batches_per_epoch': 32, 'num_microbatches': 1, 'device': device(type='cuda'), 'base_path': '../data/models/config2/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs', 'ranker': <function Trainer.iter_train.<locals>.<lambda> at 0x7fe12c0921e0>, 'ranker_path': '../data/models/config2/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs/weights/41.p', 'optimizer': <function Trainer.iter_train.<locals>.<lambda> at 0x7fe12c1c1488>, 'optimizer_path': '../data/models/config2/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs/optimizer/41.p', 'loss': 0.11829418479464948, 'losses': {'data': 0.11829418479464948}, 'acc': 0.912109375, 'unsup_acc': 0.91015625, 'cached': False}[0m
[02;37m[2020-08-19 12:36:50,877][pipeline:jesus][INFO] [0m[32mvalid run at ../data/models/config2/drmm_40q_2000d_logcount-11_5h_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs/msmarco_minidev_bm25_k1-0.82_b-0.68.20/runs/61.run[0m
[02;37m[2020-08-19 12:36:50,877][pipeline:jesus][INFO] [0m[32mvalid epoch=41 map@1000=0.2102 [mrr@10=0.2108] ndcg@20=0.2702 p@1=0.1129 p@20=0.0242 rprec=0.1169 runscore_alpha=0.1887[0m
