Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex.
[02;37m[2020-08-23 17:49:23,090][vocab:wordvec_hash][DEBUG] [0m[37m[starting] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p[0m
[02;37m[2020-08-23 17:49:28,957][vocab:wordvec_hash][DEBUG] [0m[37m[finished] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p [5.87s][0m
[02;37m[2020-08-23 17:49:40,880][trainer:pairwise][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-23 17:49:40,902][onir.injector][DEBUG] [0m[37mConfiguration:[0m
 vocab      wordvec_hash                                                  
--------------------------------------------------------------------------
 source     [33mglove[0m         |  variant      [33mcc-42b-300d[0m  |  train     False 
 hashspace  1000          |  init_stddev  0.5          |  log_miss  False 

 train_ds  microblog                                     
---------------------------------------------------------
 rankfn    bm25       |  subset  [33mtrain[0m  |  ranktopk  100 

 ranker   pacrr                                             
------------------------------------------------------------
 qlen     [33m40[0m       |  dlen     2000  |  add_runscore  [33mTrue[0m  
 mingram  1        |  maxgram  3     |  nfilters      32    
 idf      True     |  kmax     2     |  shuf          False 
 combine  dense32                                           

 trainer     pairwise                                                                                                    
-------------------------------------------------------------------------------------------------------------------------
 batch_size  16        |  batches_per_epoch  32         |  grad_acc_batch  0                                             
 optimizer   adam      |  lr                 0.001      |  gpu             True                                          
 gpu_determ  True      |  encoder_lr         0.0        |  pipeline        [33mmsmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m 
 lossfn      softmax   |  pos_source         intersect  |  neg_source      run                                           
 sampling    query     |  pos_minrel         1          |  unjudged_rel    0                                             
 num_neg     1         |  margin             0.0                                                                         

 valid_ds  microblog                                     
---------------------------------------------------------
 rankfn    bm25       |  subset  [33mvalid[0m  |  ranktopk  100 

 valid_pred  reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 test_ds  microblog                                    
-------------------------------------------------------
 rankfn   bm25       |  subset  [33mtest[0m  |  ranktopk  100 

 test_pred   reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 pipeline      jesus                                                  
----------------------------------------------------------------------
 max_epoch     1000    |  early_stop     20     |  warmup       -1    
 val_metric    [33mmrr@10[0m  |  purge_weights  True   |  test         False 
 initial_eval  False   |  skip_ds_init   False  |  only_cached  False 
 onlytest      False   |  finetune       [33mTrue[0m   |  savefile     _     
[0m
[02;37m[2020-08-23 17:49:40,902][valid_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
Starting to process general files
Starting to process general files
[02;37m[2020-08-23 17:49:40,904][trainer:pairwise][INFO] [0m[32mtrain path: ../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/microblog_train_bm25.100[0m
[02;37m[2020-08-23 17:49:44,021][trainer:pairwise][INFO] [0m[32mloading prev model : ../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/msmarco_train_bm25_k1-0.82_b-0.68.100_mspairs[0m
Reading qrels train.qrels.txt
[02;37m[2020-08-23 17:49:44,192][train_ds:microblog][DEBUG] [0m[37m[starting] loading bm25:100 from larger batch bm25:1000[0m
[02;37m[2020-08-23 17:49:44,386][train_ds:microblog][DEBUG] [0m[37m[finished] loading bm25:100 from larger batch bm25:1000 [194ms][0m
[02;37m[2020-08-23 17:49:44,490][onir.interfaces.java][DEBUG] [0m[37m[starting] initializing jnius[0m
[02;37m[2020-08-23 17:49:45,265][onir.interfaces.java][DEBUG] [0m[37m[finished] initializing jnius [775ms][0m
[02;37m[2020-08-23 17:49:50,000][pipeline:jesus][DEBUG] [0m[37m[train] epoch=0 loss=0.3549 acc=0.6621 unsup_acc=0.6172 delta_acc=0.0449[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:49:50,007][valid_ds:microblog][DEBUG] [0m[37m[starting] loading bm25:100 from larger batch bm25:1000[0m
[02;37m[2020-08-23 17:49:50,175][valid_ds:microblog][DEBUG] [0m[37m[finished] loading bm25:100 from larger batch bm25:1000 [171ms][0m
[02;37m[2020-08-23 17:49:50,179][valid_ds:microblog][DEBUG] [0m[37m[starting] loading bm25:100 from larger batch bm25:1000[0m
[02;37m[2020-08-23 17:49:50,421][valid_ds:microblog][DEBUG] [0m[37m[finished] loading bm25:100 from larger batch bm25:1000 [241ms][0m
Reading qrels valid.qrels.txt
[02;37m[2020-08-23 17:50:15,403][pipeline:jesus][INFO] [0m[32m[valid] epoch=0 map=0.0492 [mrr@10=0.9048] ndcg@10=0.2305 ndcg@20=0.2249 p@20=0.2714 runscore_alpha=0.2360 <---[0m
[02;37m[2020-08-23 17:50:18,119][pipeline:jesus][DEBUG] [0m[37m[train] epoch=1 loss=0.3729 acc=0.6445 unsup_acc=0.6230 delta_acc=0.0215[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:50:31,947][pipeline:jesus][INFO] [0m[32m[valid] epoch=1 map=0.0498 [mrr@10=0.9048] ndcg@10=0.2506 ndcg@20=0.2256 p@20=0.2643 runscore_alpha=0.2387[0m
[02;37m[2020-08-23 17:50:34,568][pipeline:jesus][DEBUG] [0m[37m[train] epoch=2 loss=0.3527 acc=0.6523 unsup_acc=0.6113 delta_acc=0.0410[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:50:48,111][pipeline:jesus][INFO] [0m[32m[valid] epoch=2 map=0.0502 [mrr@10=0.9048] ndcg@10=0.2413 ndcg@20=0.2275 p@20=0.2714 runscore_alpha=0.2443[0m
[02;37m[2020-08-23 17:50:50,752][pipeline:jesus][DEBUG] [0m[37m[train] epoch=3 loss=0.3310 acc=0.7012 unsup_acc=0.6172 delta_acc=0.0840[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:51:04,794][pipeline:jesus][INFO] [0m[32m[valid] epoch=3 map=0.0539 [mrr@10=0.8095] ndcg@10=0.2773 ndcg@20=0.2473 p@20=0.2929 runscore_alpha=0.2524[0m
[02;37m[2020-08-23 17:51:07,400][pipeline:jesus][DEBUG] [0m[37m[train] epoch=4 loss=0.3087 acc=0.7129 unsup_acc=0.6504 delta_acc=0.0625[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:51:20,970][pipeline:jesus][INFO] [0m[32m[valid] epoch=4 map=0.0538 [mrr@10=0.8095] ndcg@10=0.2923 ndcg@20=0.2511 p@20=0.2929 runscore_alpha=0.2598[0m
[02;37m[2020-08-23 17:51:23,562][pipeline:jesus][DEBUG] [0m[37m[train] epoch=5 loss=0.3160 acc=0.7031 unsup_acc=0.5820 delta_acc=0.1211[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:51:37,318][pipeline:jesus][INFO] [0m[32m[valid] epoch=5 map=0.0559 [mrr@10=0.8333] ndcg@10=0.3047 ndcg@20=0.2606 p@20=0.3000 runscore_alpha=0.2689[0m
[02;37m[2020-08-23 17:51:39,843][pipeline:jesus][DEBUG] [0m[37m[train] epoch=6 loss=0.3135 acc=0.7090 unsup_acc=0.6016 delta_acc=0.1074[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:51:53,037][pipeline:jesus][INFO] [0m[32m[valid] epoch=6 map=0.0585 [mrr@10=0.9048] ndcg@10=0.3128 ndcg@20=0.2724 p@20=0.3071 runscore_alpha=0.2764[0m
[02;37m[2020-08-23 17:51:55,500][pipeline:jesus][DEBUG] [0m[37m[train] epoch=7 loss=0.2863 acc=0.7383 unsup_acc=0.6191 delta_acc=0.1191[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:52:08,981][pipeline:jesus][INFO] [0m[32m[valid] epoch=7 map=0.0580 [mrr@10=0.9048] ndcg@10=0.3101 ndcg@20=0.2753 p@20=0.3143 runscore_alpha=0.2830[0m
[02;37m[2020-08-23 17:52:11,399][pipeline:jesus][DEBUG] [0m[37m[train] epoch=8 loss=0.3009 acc=0.7188 unsup_acc=0.5820 delta_acc=0.1367[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:52:25,212][pipeline:jesus][INFO] [0m[32m[valid] epoch=8 map=0.0586 [mrr@10=0.8333] ndcg@10=0.3115 ndcg@20=0.2768 p@20=0.3143 runscore_alpha=0.2895[0m
[02;37m[2020-08-23 17:52:27,714][pipeline:jesus][DEBUG] [0m[37m[train] epoch=9 loss=0.3043 acc=0.7109 unsup_acc=0.6074 delta_acc=0.1035[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:52:41,932][pipeline:jesus][INFO] [0m[32m[valid] epoch=9 map=0.0580 [mrr@10=0.8333] ndcg@10=0.3196 ndcg@20=0.2780 p@20=0.3214 runscore_alpha=0.2945[0m
[02;37m[2020-08-23 17:52:44,435][pipeline:jesus][DEBUG] [0m[37m[train] epoch=10 loss=0.2612 acc=0.7539 unsup_acc=0.6172 delta_acc=0.1367[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:52:58,485][pipeline:jesus][INFO] [0m[32m[valid] epoch=10 map=0.0582 [mrr@10=0.8333] ndcg@10=0.3127 ndcg@20=0.2701 p@20=0.3000 runscore_alpha=0.3000[0m
[02;37m[2020-08-23 17:53:00,887][pipeline:jesus][DEBUG] [0m[37m[train] epoch=11 loss=0.2899 acc=0.7188 unsup_acc=0.6016 delta_acc=0.1172[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:53:14,490][pipeline:jesus][INFO] [0m[32m[valid] epoch=11 map=0.0580 [mrr@10=0.8333] ndcg@10=0.3214 ndcg@20=0.2699 p@20=0.3000 runscore_alpha=0.3049[0m
[02;37m[2020-08-23 17:53:16,838][pipeline:jesus][DEBUG] [0m[37m[train] epoch=12 loss=0.2888 acc=0.7266 unsup_acc=0.6035 delta_acc=0.1230[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:53:30,307][pipeline:jesus][INFO] [0m[32m[valid] epoch=12 map=0.0598 [mrr@10=0.8333] ndcg@10=0.3252 ndcg@20=0.2692 p@20=0.3000 runscore_alpha=0.3092[0m
[02;37m[2020-08-23 17:53:32,670][pipeline:jesus][DEBUG] [0m[37m[train] epoch=13 loss=0.2809 acc=0.7246 unsup_acc=0.6152 delta_acc=0.1094[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:53:46,148][pipeline:jesus][INFO] [0m[32m[valid] epoch=13 map=0.0616 [mrr@10=0.8333] ndcg@10=0.3431 ndcg@20=0.2789 p@20=0.2929 runscore_alpha=0.3137[0m
[02;37m[2020-08-23 17:53:48,470][pipeline:jesus][DEBUG] [0m[37m[train] epoch=14 loss=0.2779 acc=0.7266 unsup_acc=0.6309 delta_acc=0.0957[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:54:01,945][pipeline:jesus][INFO] [0m[32m[valid] epoch=14 map=0.0675 [mrr@10=0.8214] ndcg@10=0.3600 ndcg@20=0.2984 p@20=0.3000 runscore_alpha=0.3183[0m
[02;37m[2020-08-23 17:54:04,268][pipeline:jesus][DEBUG] [0m[37m[train] epoch=15 loss=0.2907 acc=0.7188 unsup_acc=0.5703 delta_acc=0.1484[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:54:17,611][pipeline:jesus][INFO] [0m[32m[valid] epoch=15 map=0.0675 [mrr@10=0.8333] ndcg@10=0.3603 ndcg@20=0.3006 p@20=0.3071 runscore_alpha=0.3225[0m
[02;37m[2020-08-23 17:54:19,908][pipeline:jesus][DEBUG] [0m[37m[train] epoch=16 loss=0.3015 acc=0.7070 unsup_acc=0.5879 delta_acc=0.1191[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:54:33,150][pipeline:jesus][INFO] [0m[32m[valid] epoch=16 map=0.0674 [mrr@10=0.8214] ndcg@10=0.3603 ndcg@20=0.2946 p@20=0.3000 runscore_alpha=0.3264[0m
[02;37m[2020-08-23 17:54:35,636][pipeline:jesus][DEBUG] [0m[37m[train] epoch=17 loss=0.2789 acc=0.7246 unsup_acc=0.6230 delta_acc=0.1016[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:54:48,984][pipeline:jesus][INFO] [0m[32m[valid] epoch=17 map=0.0649 [mrr@10=0.8333] ndcg@10=0.3556 ndcg@20=0.2906 p@20=0.3000 runscore_alpha=0.3287[0m
[02;37m[2020-08-23 17:54:51,253][pipeline:jesus][DEBUG] [0m[37m[train] epoch=18 loss=0.2697 acc=0.7305 unsup_acc=0.6113 delta_acc=0.1191[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:55:04,757][pipeline:jesus][INFO] [0m[32m[valid] epoch=18 map=0.0686 [mrr@10=0.8333] ndcg@10=0.3627 ndcg@20=0.2960 p@20=0.3000 runscore_alpha=0.3313[0m
[02;37m[2020-08-23 17:55:07,109][pipeline:jesus][DEBUG] [0m[37m[train] epoch=19 loss=0.2593 acc=0.7461 unsup_acc=0.6172 delta_acc=0.1289[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:55:20,279][pipeline:jesus][INFO] [0m[32m[valid] epoch=19 map=0.0679 [mrr@10=0.8333] ndcg@10=0.3613 ndcg@20=0.2949 p@20=0.3000 runscore_alpha=0.3338[0m
[02;37m[2020-08-23 17:55:22,585][pipeline:jesus][DEBUG] [0m[37m[train] epoch=20 loss=0.2827 acc=0.7285 unsup_acc=0.5977 delta_acc=0.1309[0m
Pacrr(
  (encoder): WordvecEncoder(
    (embed): Embedding(1918495, 300)
  )
  (simmat): InteractionMatrix()
  (ngrams): ModuleList(
    (0): ConvMax2d(
      (conv): Conv2d(1, 32, kernel_size=(1, 1), stride=(1, 1))
      (activation): ReLU()
    )
    (1): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 1, 0, 1), value=0)
      (conv): Conv2d(1, 32, kernel_size=(2, 2), stride=(1, 1))
      (activation): ReLU()
    )
    (2): ConvMax2d(
      (pad): ConstantPad2d(padding=(0, 2, 0, 2), value=0)
      (conv): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
      (activation): ReLU()
    )
  )
  (combination): DenseCombination(
    (hidden): ModuleList(
      (0): Linear(in_features=280, out_features=32, bias=True)
      (1): Linear(in_features=32, out_features=32, bias=True)
      (2): Linear(in_features=32, out_features=1, bias=True)
    )
  )
) <generator object Reranker._reload_batches at 0x7f5c3a7c4048>
[02;37m[2020-08-23 17:55:35,940][pipeline:jesus][INFO] [0m[32m[valid] epoch=20 map=0.0646 [mrr@10=0.8333] ndcg@10=0.3565 ndcg@20=0.2909 p@20=0.3000 runscore_alpha=0.3369[0m
[02;37m[2020-08-23 17:55:35,941][pipeline:jesus][WARNING] [0m[33mstopping after epoch 20 (20 epochs with no improvement to mrr@10)[0m
[02;37m[2020-08-23 17:55:35,941][pipeline:jesus][INFO] [0m[32mtop validation epoch=0 mrr@10=0.9047619047619048[0m
[02;37m[2020-08-23 17:55:35,941][pipeline:jesus][INFO] [0m[32m[jesus: top_train_ctxt] {'epoch': 0, 'batch_size': 16, 'batches_per_epoch': 32, 'num_microbatches': 1, 'device': device(type='cuda'), 'base_path': '../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/microblog_train_bm25.100', 'ranker': <function Trainer.iter_train.<locals>.<lambda> at 0x7f5c2b26ac80>, 'ranker_path': '../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/microblog_train_bm25.100/weights/0.p', 'optimizer': <function Trainer.iter_train.<locals>.<lambda> at 0x7f5c2b26ad08>, 'optimizer_path': '../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/microblog_train_bm25.100/optimizer/0.p', 'loss': 0.3549146382138133, 'losses': {'data': 0.3549146382138133}, 'acc': 0.662109375, 'unsup_acc': 0.6171875, 'cached': False}[0m
[02;37m[2020-08-23 17:55:35,942][pipeline:jesus][INFO] [0m[32mvalid run at ../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/microblog_train_bm25.100/microblog_valid_bm25.100/runs/20.run[0m
[02;37m[2020-08-23 17:55:35,942][pipeline:jesus][INFO] [0m[32mvalid epoch=0 map=0.0492 [mrr@10=0.9048] ndcg@10=0.2305 ndcg@20=0.2249 p@20=0.2714 runscore_alpha=0.2360[0m
