Better speed can be achieved with apex installed from https://www.github.com/nvidia/apex.
[02;37m[2020-08-23 17:55:39,637][vocab:wordvec_hash][DEBUG] [0m[37m[starting] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p[0m
[02;37m[2020-08-23 17:55:43,972][vocab:wordvec_hash][DEBUG] [0m[37m[finished] reading cached at ../data/vocab/wordvec_hash/glove-cc-42b-300d.p [4.33s][0m
[02;37m[2020-08-23 17:55:49,304][trainer:pairwise][DEBUG] [0m[37musing GPU (deterministic)[0m
[02;37m[2020-08-23 17:55:49,313][onir.injector][DEBUG] [0m[37mConfiguration:[0m
 vocab      wordvec_hash                                                  
--------------------------------------------------------------------------
 source     [33mglove[0m         |  variant      [33mcc-42b-300d[0m  |  train     False 
 hashspace  1000          |  init_stddev  0.5          |  log_miss  False 

 train_ds  microblog                                     
---------------------------------------------------------
 rankfn    bm25       |  subset  [33mtrain[0m  |  ranktopk  100 

 ranker   pacrr                                             
------------------------------------------------------------
 qlen     [33m40[0m       |  dlen     2000  |  add_runscore  [33mTrue[0m  
 mingram  1        |  maxgram  3     |  nfilters      32    
 idf      True     |  kmax     2     |  shuf          False 
 combine  dense32                                           

 trainer     pairwise                                                                                
-----------------------------------------------------------------------------------------------------
 batch_size  16        |  batches_per_epoch  32         |  grad_acc_batch  0                         
 optimizer   adam      |  lr                 0.001      |  gpu             True                      
 gpu_determ  True      |  encoder_lr         0.0        |  pipeline        [33mmicroblog_train_bm25.1000[0m 
 lossfn      softmax   |  pos_source         intersect  |  neg_source      run                       
 sampling    query     |  pos_minrel         1          |  unjudged_rel    0                         
 num_neg     1         |  margin             0.0                                                     

 valid_ds  microblog                                     
---------------------------------------------------------
 rankfn    bm25       |  subset  [33mvalid[0m  |  ranktopk  100 

 valid_pred  reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 test_ds  microblog                                    
-------------------------------------------------------
 rankfn   bm25       |  subset  [33mtest[0m  |  ranktopk  100 

 test_pred   reranker                                                                         
----------------------------------------------------------------------------------------------
 batch_size  64        |  gpu            True  |  gpu_determ  True                            
 preload     False     |  run_threshold  0     |  measures    [33mmrr@10,ndcg@20,map,p@20,ndcg@10[0m 
 source      run                                                                              

 pipeline      jesus                                                                                                     
-------------------------------------------------------------------------------------------------------------------------
 max_epoch     1000    |  early_stop     20     |  warmup       -1                                                       
 val_metric    [33mmrr@10[0m  |  purge_weights  True   |  test         [33mTrue[0m                                                     
 initial_eval  False   |  skip_ds_init   False  |  only_cached  False                                                    
 onlytest      [33mTrue[0m    |  finetune       [33mTrue[0m   |  savefile     [33mmodel_pacrr-train_msmarco-train_microblog-test_microblog[0m 
[0m
[02;37m[2020-08-23 17:55:49,313][valid_pred:reranker][DEBUG] [0m[37musing GPU (deterministic)[0m
Starting to process general files
Starting to process general files
Starting to process general files
[02;37m[2020-08-23 17:55:49,314][trainer:pairwise][INFO] [0m[32mtrain path: ../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/microblog_train_bm25.100[0m
[02;37m[2020-08-23 17:55:52,675][trainer:pairwise][INFO] [0m[32mloading prev model : ../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/microblog_train_bm25.1000[0m
[02;37m[2020-08-23 17:55:52,676][onir][CRITICAL] [0m[01;31mUncaught exception
Traceback (most recent call last):
  File "/local/jlovon/miniconda3/envs/openir/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/local/jlovon/miniconda3/envs/openir/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/local/jlovon/catfog-i/OpenNIR/onir/bin/pipeline.py", line 21, in <module>
    main()
  File "/local/jlovon/catfog-i/OpenNIR/onir/bin/pipeline.py", line 17, in main
    context['pipeline'].run()
  File "/local/jlovon/catfog-i/OpenNIR/onir/pipelines/jesus.py", line 59, in run
    for train_ctxt in self.trainer.iter_train(only_cached=self.config['only_cached'], _top_epoch=self.config.get('finetune')):
  File "/local/jlovon/catfog-i/OpenNIR/onir/trainers/base.py", line 79, in iter_train
    ranker.load(w_path)
  File "/local/jlovon/catfog-i/OpenNIR/onir/rankers/base.py", line 68, in load
    self.load_state_dict(torch.load(path), strict=False)
  File "/local/jlovon/miniconda3/envs/openir/lib/python3.6/site-packages/torch/serialization.py", line 419, in load
    f = open(f, 'rb')
FileNotFoundError: [Errno 2] No such file or directory: '../data/models/config3/pacrr_40q_2000d_ng-1-3_k-2_idf_addrun/wordvec_hash_glove_cc-42b-300d/pairwise_32x16_adam-0.001_softmax_pos-intersect-query_neg-run/microblog_train_bm25.1000/weights/-2.p'[0m
